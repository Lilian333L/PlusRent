<!DOCTYPE html>
<html lang="ro">

<head>
  <title>Mașini de închiriat în Chișinău și Moldova – PlusRent | Flotă actualizată</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="images/icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
  <link rel="shortcut icon" type="image/png" href="images/icon.png">

  <!-- Meta Base -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ffffff">
  <meta name="msapplication-TileImage" content="images/icon.png">
  <meta name="msapplication-TileColor" content="#ffffff">

  <!-- SEO -->
  <meta name="description" content="Descoperă toate mașinile disponibile pentru închiriere la PlusRent. Autoturisme moderne, economice și premium, livrare rapidă în Chișinău sau oriunde în Moldova.">
  <meta name="author" content="PlusRent.md">
  <meta name="robots" content="index, follow">

  <!-- Canonical -->
  <link rel="canonical" href="https://plusrent.md/cars">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Mașini de închiriat în Chișinău și Moldova – PlusRent">
  <meta property="og:description" content="Vezi flota completă de mașini disponibile la PlusRent. Închirieri rapide și sigure, cu livrare gratuită în Chișinău și la Aeroport.">
  <meta property="og:image" content="https://plusrent.md/images/LOGO-5-demo.png">
  <meta property="og:url" content="https://plusrent.md/cars">
  <meta property="og:site_name" content="PlusRent">
  <meta property="og:locale" content="ro_RO">
  <meta property="og:locale:alternate" content="ru_RU">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Mașini de închiriat în Chișinău – PlusRent">
  <meta name="twitter:description" content="Explorează gama completă de mașini disponibile pentru închiriere la PlusRent.">
  <meta name="twitter:image" content="https://plusrent.md/images/LOGO-5-demo.png">

  <!-- CSS Files -->
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap">
  <link href="css/mdb.min.css" rel="stylesheet" type="text/css" id="mdb">
  <link href="css/plugins.css" rel="stylesheet" type="text/css">
  <link href="css/style.css" rel="stylesheet" type="text/css">
  <link href="css/coloring.css" rel="stylesheet" type="text/css">
  <link id="colors" href="css/colors/scheme-01.css" rel="stylesheet" type="text/css">

  <!-- FontAwesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

  <!-- Flatpickr for date picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css">

  <!-- Cars Filter Modal -->
  <link href="css/cars-filter-modal.css" rel="stylesheet" type="text/css">

  <!-- API Config -->
  <script>
    window.API_BASE_URL = '';
  </script>

  <!-- Config Script -->
  <script src="js/config.js"></script>

  <!-- i18n (multilingv) -->
  <script src="https://unpkg.com/i18next@21.6.14/dist/umd/i18next.min.js"></script>
  <script src="https://unpkg.com/i18next-http-backend@1.4.3/i18nextHttpBackend.min.js"></script>
  <script src="js/i18n-init.js"></script>

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "AutoRental",
    "name": "PlusRent",
    "image": "https://plusrent.md/images/LOGO-5-demo.png",
    "logo": "https://plusrent.md/images/icon.png",
    "@id": "https://plusrent.md",
    "url": "https://plusrent.md/cars",
    "description": "Flotă completă de mașini disponibile pentru închiriere în Chișinău și Moldova, cu livrare la aeroport și asistență 24/7.",
    "priceRange": "€25-€120",
    "telephone": "+373-60-000-500",
    "email": "info@plusrent.md",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "str. Meșterul Manole 20",
      "addressLocality": "Chișinău",
      "postalCode": "MD-2001",
      "addressCountry": "MD"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 47.0105,
      "longitude": 28.8638
    },
    "openingHoursSpecification": {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": [
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
        "Sunday"
      ],
      "opens": "00:00",
      "closes": "23:59"
    },
    "sameAs": [
      "https://www.instagram.com/plusrent.md",
      "https://t.me/plusrent",
      "https://www.tiktok.com/@plusrent"
    ]
  }
  </script>
  
  <style>
    /* Enhanced Professional Design System */
    :root {
      --primary-color: #1976d2;
      --primary-dark: #115293;
      --secondary-color: #f0c040;
      --success-color: #4caf50;
      --danger-color: #f44336;
      --warning-color: #ff9800;
      --info-color: #2196f3;
      --light-bg: #f8f9fa;
      --border-color: #e0e0e0;
      --text-primary: #212529;
      --text-secondary: #6c757d;
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.16);
      --transition-speed: 0.3s;
    }

    /* Language Picker Styles */
    .lang-picker-wrapper { 
      position: relative; 
      display: inline-block; 
      vertical-align: middle; 
    }
    
    .lang-picker-btn {
      display: flex;
      align-items: center;
      gap: 7px;
      padding: 4px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      background: white;
      cursor: pointer;
      font-weight: 500;
      font-size: 14px;
      min-width: 90px;
      height: 38px;
      line-height: 1.2;
      transition: all var(--transition-speed);
      box-shadow: var(--shadow-sm);
    }
    
    .lang-picker-btn:hover {
      border-color: var(--primary-color);
      box-shadow: var(--shadow-md);
    }
    
    .lang-picker-dropdown {
      display: none;
      position: absolute;
      top: 110%;
      left: 0;
      z-index: 1000;
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      box-shadow: var(--shadow-lg);
      padding: 4px;
      margin: 0;
      min-width: 120px;
      list-style: none;
    }
    
    .lang-picker-dropdown.open { display: block; }
    .lang-option {
      display: flex;
      align-items: center;
      gap: 7px;
      padding: 7px 14px;
      cursor: pointer;
      font-size: 14px;
      background: none;
      border: none;
      transition: background 0.15s, color 0.15s;
      height: 32px;
      line-height: 1.2;
    }
    
    .lang-option:hover {
      background: var(--light-bg);
    }
    
    .lang-option.selected {
      background: var(--primary-color);
      color: white;
    }
    
    .lang-flag {
      width: 20px;
      height: 15px;
    }
    
    .lang-flag img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 2px;
    }

    /* Enhanced Filter Sidebar Styles */
    .filter-sidebar {
      background: white;
      border-radius: 12px;
      box-shadow: var(--shadow-md);
      padding: 24px;
      position: sticky;
      top: 20px;
    }
    
    .filter-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .filter-clear {
      font-size: 0.875rem;
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }
    
    .filter-clear:hover {
      color: var(--primary-dark);
      text-decoration: underline;
    }
    
    .filter-divider {
      border: none;
      border-top: 1px solid var(--border-color);
      margin: 1.5rem 0;
    }
    
    .filter-section-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-primary);
    }
    
    /* Date Range Picker Styles */
    .date-range-picker {
      margin-bottom: 1.5rem;
    }
    
    .date-input-group {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 0.5rem;
    }
    
    .date-input-wrapper {
      flex: 1;
      position: relative;
    }
    
    .date-input-wrapper input {
      width: 100%;
      padding: 10px 40px 10px 12px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    .date-input-wrapper input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
    }
    
    .date-input-wrapper .icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      pointer-events: none;
    }
    
    /* Sort Options Styles */
    .sort-section {
      background: var(--light-bg);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 1.5rem;
    }
    
    .sort-select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: white;
      font-size: 14px;
      cursor: pointer;
      transition: border-color 0.3s;
    }
    
    .sort-select:focus {
      outline: none;
      border-color: var(--primary-color);
    }
    
    /* Filter Options Styles */
    .filter-option-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
      transition: background 0.2s;
      border-radius: 4px;
    }
    
    .filter-option-row:hover {
      background: var(--light-bg);
      padding: 8px;
    }
    
    .filter-option-row label {
      display: flex;
      align-items: center;
      cursor: pointer;
      flex: 1;
    }
    
    .filter-option-row input[type="checkbox"],
    .filter-option-row input[type="radio"] {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      accent-color: var(--primary-color);
      cursor: pointer;
    }
    
    .option-label {
      font-size: 14px;
      color: var(--text-primary);
      flex: 1;
    }
    
    .option-count {
      background: var(--light-bg);
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      min-width: 28px;
      text-align: center;
    }
    
    /* Disabled Options */
    .filter-option-row.disabled-option {
      opacity: 0.5;
      pointer-events: none;
    }
    
    .filter-option-row.disabled-option:hover {
      background: transparent;
    }

    /* Car Card Styles */
    .car-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-md);
      transition: all var(--transition-speed);
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .car-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }
    
    .car-card.premium {
      border: 2px solid var(--secondary-color);
      position: relative;
    }
    
    .car-card .car-image-wrapper {
      position: relative;
      height: 220px;
      overflow: hidden;
      background: var(--light-bg);
    }
    
    .car-card .car-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
    
    .car-card:hover .car-image {
      transform: scale(1.05);
    }
    
    .premium-badge {
      position: absolute;
      top: 12px;
      left: 12px;
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #333;
      padding: 6px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      box-shadow: var(--shadow-md);
      z-index: 2;
    }
    
    .car-card .car-details {
      padding: 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .car-card .car-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }
    
    .car-card .car-model {
      color: var(--text-secondary);
      margin-bottom: 16px;
      font-size: 14px;
    }
    
    .car-features {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin: 16px 0;
    }
    
    .car-feature {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    .car-feature i {
      color: var(--primary-color);
      width: 16px;
    }
    
    .car-price {
      margin-top: auto;
      padding-top: 16px;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .price-label {
      font-size: 14px;
      color: var(--text-secondary);
    }
    
    .price-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }
    
    .btn-rent {
      display: block;
      width: 100%;
      padding: 12px 24px;
      background: var(--primary-color);
      color: white;
      text-align: center;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s;
      margin-top: 16px;
    }
    
    .btn-rent:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    
    .btn-unavailable {
      background: var(--text-secondary) !important;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Mobile Filter Button */
    .mobile-filter-button-container {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
      display: none;
    }
    
    @media (max-width: 991px) {
      .mobile-filter-button-container {
        display: block;
      }
    }
    
    .mobile-filter-btn {
      padding: 14px 32px;
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 25px;
      font-weight: 600;
      font-size: 16px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }
    
    .mobile-filter-btn:hover {
      background: var(--primary-dark);
      transform: scale(1.05);
    }

    /* Mobile Filter Overlay - Fixed Scrolling */
    .mobile-filter-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      display: none;
      backdrop-filter: blur(4px);
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    }
    
    .mobile-filter-overlay.active {
      display: block;
    }
    
    .mobile-filter-sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 85%;
      max-width: 400px;
      height: 100%;
      height: 100vh; /* Use viewport height */
      height: -webkit-fill-available; /* iOS fix */
      background: white;
      box-shadow: var(--shadow-lg);
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
      transform: translateX(-100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
    }
    
    .mobile-filter-overlay.active .mobile-filter-sidebar {
      transform: translateX(0);
    }
    
    .mobile-filter-header {
      position: sticky;
      position: -webkit-sticky; /* iOS compatibility */
      top: 0;
      background: var(--primary-color);
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 10;
      flex-shrink: 0;
    }
    
    .mobile-filter-header h5 {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 600;
    }
    
    .mobile-filter-close {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
    }
    
    .mobile-filter-content {
      padding: 20px;
      overflow-y: auto;
      flex: 1;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    }
    
    .mobile-filter-actions {
      position: sticky;
      position: -webkit-sticky; /* iOS compatibility */
      bottom: 0;
      background: white;
      padding: 20px;
      border-top: 1px solid var(--border-color);
      display: flex;
      gap: 12px;
      flex-shrink: 0;
    }
    
    .mobile-filter-actions .btn {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .mobile-filter-actions .btn-clear {
      background: white;
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
    }
    
    .mobile-filter-actions .btn-apply {
      background: var(--primary-color);
      border: none;
      color: white;
    }

    /* Responsive Grid */
    @media (max-width: 767px) {
      .car-list-container {
        padding: 0 15px;
      }
      
      .car-card {
        margin-bottom: 20px;
      }
      
      .filter-sidebar {
        display: none;
      }
    }
    
    @media (min-width: 768px) and (max-width: 991px) {
      .filter-sidebar {
        display: none;
      }
    }
    
    @media (min-width: 992px) {
      .mobile-filter-button-container {
        display: none !important;
      }
      
      .mobile-filter-overlay {
        display: none !important;
      }
    }

    /* Loading Spinner */
    .loading-spinner {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 400px;
    }
    
    .spinner-border {
      width: 3rem;
      height: 3rem;
      border-width: 0.3em;
    }
    
    /* Cars Filter Modal Integration Styles */
    .filter-card.selected {
      background: linear-gradient(135deg, #1976d2, #1565c0) !important;
      transform: scale(1.05);
      box-shadow: 0 8px 24px rgba(25, 118, 210, 0.3) !important;
    }
    
    .filter-card.selected .filter-card-content {
      color: white !important;
    }
    
    .filter-card.selected .filter-card-icon {
      color: white !important;
      background: rgba(255, 255, 255, 0.2) !important;
    }
    
    .filter-card.selected .filter-card-title,
    .filter-card.selected .filter-card-description {
      color: white !important;
    }
    
    /* Ensure body scroll lock works properly on iOS */
    body.modal-open {
      position: fixed !important;
      width: 100% !important;
      height: 100vh !important;
      overflow: hidden !important;
      -webkit-overflow-scrolling: auto !important;
    }
  </style>
</head>

<body>
    <div id="wrapper">
        
        <!-- page preloader begin -->
        <div id="de-preloader"></div>
        <!-- page preloader close -->

        <!-- header begin -->
        <header class="transparent scroll-light has-topbar">
            <div id="topbar" class="topbar-dark text-light">
                <div class="container">
                    <div class="topbar-left xs-hide">
                        <div class="topbar-widget">
                            <div class="topbar-widget"><a href="tel:+37360000500"><i class="fa fa-phone"></i>+373 60 000 500</a></div>
                            <div class="topbar-widget"><a href="mailto:contact@plusrent.md"><i class="fa fa-envelope"></i>contact@plusrent.md</a></div>
                            <div class="topbar-widget"><i class="fa fa-clock-o"></i>24/7</div>
                        </div>
                    </div>
                
                    <div class="topbar-right">
                        <div class="social-icons">
                            <a href="https://www.instagram.com/plusrent.md/" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram fa-lg"></i></a>
                            <a href="https://tiktok.me/plusrent" target="_blank" rel="noopener noreferrer"><i class="fab fa-tiktok fa-lg"></i></a>
                        </div>
                    </div>  
                    <div class="clearfix"></div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="de-flex sm-pt10">
                            <div class="de-flex-col">
                                <div class="de-flex-col">
                                    <!-- logo begin -->
                                    <div id="logo">
                                        <a href="/">
                                            <img class="logo-1" src="images/LOGO-4-demo.png" alt="">
                                            <img class="logo-2" src="images/LOGO-5-demo.png" alt="">
                                        </a>
                                    </div>
                                    <!-- logo close -->
                                </div>
                            </div>
                            
                            <div class="de-flex-col">
                                <!-- Main Menu -->
                                <ul id="mainmenu">
                                  <li><a class="menu-item" href="/" data-i18n="menu.home"></a></li>
                                  <li><a class="menu-item" href="/cars" data-i18n="menu.cars"></a></li>
                                  <li><a class="menu-item" href="/about" data-i18n="menu.about"></a></li>
                                  <li><a class="menu-item" href="/contact" data-i18n="menu.contact"></a></li>
                                  <li><a class="menu-item" href="/sofer-treaz" data-i18n="menu.sober_driver"></a></li>
                                </ul>
                            </div>
                            
                            <div class="de-flex-col">
                                <div class="menu_side_area" style="display: flex; align-items: center; justify-content: flex-end; gap: 12px; ">
                                    <!-- Call Now Button -->
                                    <div class="call-now-wrapper" style="align-self:center; margin-right: 2vw;">
                                        <a href="tel:060000500" class="call-now-btn" style="display: flex; align-items: center; gap: 8px; background: linear-gradient(135deg, #1E90FF, #187bcd); color: white; padding: 10px 16px; border-radius: 25px; text-decoration: none; font-weight: 600; font-size: 14px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(30, 144, 255, 0.3); position: relative; overflow: hidden;">
                                            <i class="fa fa-phone" style="font-size: 12px;"></i>
                                            <span data-i18n="call_now">Call Now</span>
                                        </a>
                                    </div>
                                    <!-- Language Picker -->
                                    <div class="lang-picker-wrapper" style="min-width:120px;align-self:center;">
                                      <button id="langPickerBtn" class="lang-picker-btn" aria-haspopup="listbox" aria-expanded="false" style="height:36px;display:flex;align-items:center;">
                                        <span class="lang-globe" id="langGlobe" style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;margin-right:3px;">
                                          <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="9" stroke="#1ccfc9" stroke-width="2"/><ellipse cx="10" cy="10" rx="5" ry="9" stroke="#1ccfc9" stroke-width="2"/><path d="M1 10h18" stroke="#1ccfc9" stroke-width="2"/><path d="M3 4.5h14" stroke="#1ccfc9" stroke-width="1.2"/><path d="M3 15.5h14" stroke="#1ccfc9" stroke-width="1.2"/></svg>
                                        </span>
                                        <span class="lang-flag" id="langFlag"></span>
                                        <span id="langCode" style="font-weight:600;margin:0 2px 0 2px;">RO</span>
                                        <svg width="14" height="14" viewBox="0 0 20 20" style="margin-left:6px;"><path d="M5.5 8l4.5 4.5L14.5 8" stroke="#888" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
                                      </button>
                                      <ul id="langDropdown" class="lang-picker-dropdown" tabindex="-1">
                                        <li class="lang-option" data-lang="ro" tabindex="0"><span class="lang-flag"><img src="images/flags/romania.png" alt="RO" style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span class="lang-code">RO</span></li>
                                        <li class="lang-option" data-lang="en" tabindex="0"><span class="lang-flag"><img src="images/flags/united-kingdom.png" alt="EN" style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span class="lang-code">EN</span></li>
                                        <li class="lang-option" data-lang="ru" tabindex="0"><span class="lang-flag"><img src="images/flags/russia.png" alt="RU" style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span class="lang-code">RU</span></li>
                                      </ul>
                                    </div>
                                </div>
                            </div>

                            
                            <div id="menu-btn">
                              <span></span>
                              <span></span>
                              <span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- header close -->
        
        <!-- content begin -->
        <div class="no-bottom no-top zebra" id="content">
            <div id="top"></div>
            
            <!-- section begin -->
            <section id="subheader" class="jarallax text-light">
                <img src="images/background/2.jpg" class="jarallax-img" alt="">
                <div class="center-y relative text-center">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12 text-center">
                                <h1 data-i18n="cars.page_title">Our Fleet</h1>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- section close -->

            <!-- Cars Section -->
            <section class="py-5">
                <div class="container">
                    <div class="row">
                        <!-- Desktop Sidebar -->
                        <div class="col-lg-3 d-none d-lg-block">
                            <div class="filter-sidebar">
                                <div class="filter-title">
                                    <span data-i18n="cars.filters">Filters</span>
                                    <a href="#" class="filter-clear" id="clear-filters-link" data-i18n="cars.clear_filters">Clear all</a>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Date Range Filter -->
                                <div class="filter-category date-range-picker">
                                    <h6 class="filter-section-title" data-i18n="cars.availability_period">Availability Period</h6>
                                    <div class="date-input-group">
                                        <div class="date-input-wrapper">
                                            <input type="text" id="date-from" class="form-control" placeholder="From" data-i18n-placeholder="cars.date_from">
                                            <i class="fa fa-calendar icon"></i>
                                        </div>
                                        <span>-</span>
                                        <div class="date-input-wrapper">
                                            <input type="text" id="date-to" class="form-control" placeholder="To" data-i18n-placeholder="cars.date_to">
                                            <i class="fa fa-calendar icon"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Sort Options -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.sort_by">Sort By</h6>
                                    <select id="sort-select" class="sort-select">
                                        <option value="default" data-i18n="cars.sort_default">Default</option>
                                        <option value="price_asc" data-i18n="cars.sort_price_asc">Price: Low to High</option>
                                        <option value="price_desc" data-i18n="cars.sort_price_desc">Price: High to Low</option>
                                    </select>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Price Category Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.price_category">Price Category</h6>
                                    <div class="filter-option-row">
                                        <label>
                                            <input type="radio" name="price-category" value="all" checked>
                                            <span class="option-label" data-i18n="cars.all_categories">All Categories</span>
                                        </label>
                                    </div>
                                    <div class="filter-option-row">
                                        <label>
                                            <input type="radio" name="price-category" value="economy">
                                            <span class="option-label" data-i18n="cars.economy">Economy</span>
                                        </label>
                                    </div>
                                    <div class="filter-option-row">
                                        <label>
                                            <input type="radio" name="price-category" value="standard">
                                            <span class="option-label" data-i18n="cars.standard">Standard</span>
                                        </label>
                                    </div>
                                    <div class="filter-option-row">
                                        <label>
                                            <input type="radio" name="price-category" value="premium">
                                            <span class="option-label" data-i18n="cars.premium">Premium</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Fuel Type Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.fuel_type">Fuel Type</h6>
                                    <div id="filter-fuel-options"></div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Car Type Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.car_type">Car Type</h6>
                                    <div id="filter-type-options"></div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Make Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.make">Make</h6>
                                    <div id="filter-make-options"></div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Transmission Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.filter_gear">Transmission</h6>
                                    <div id="filter-gear-options"></div>
                                </div>
                                
                                <div class="filter-divider"></div>
                                
                                <!-- Passengers Filter -->
                                <div class="filter-category">
                                    <h6 class="filter-section-title" data-i18n="cars.passengers">Passengers</h6>
                                    <div id="filter-passengers-options"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Main Content Area -->
                        <div class="col-lg-9 col-12">
                            <div class="row" id="car-list">
                                <!-- Cars will be loaded here -->
                                <div class="loading-spinner">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Mobile Filter Button -->
            <div class="mobile-filter-button-container">
                <button class="mobile-filter-btn" onclick="toggleMobileFilter()">
                    <i class="fa fa-filter"></i>
                    <span data-i18n="cars.filter">Filter</span>
                </button>
            </div>

            <!-- Mobile Filter Overlay -->
            <div class="mobile-filter-overlay" id="mobile-filter-overlay">
                <div class="mobile-filter-sidebar">
                    <div class="mobile-filter-header">
                        <h5 data-i18n="cars.filter_cars">Filter Cars</h5>
                        <button class="mobile-filter-close" onclick="toggleMobileFilter()">
                            <i class="fa fa-times"></i>
                        </button>
                    </div>
                    <div class="mobile-filter-content">
                        <!-- Mobile filters will be populated here -->
                        <div id="mobile-filter-options"></div>
                    </div>
                    <div class="mobile-filter-actions">
                        <button class="btn btn-clear" onclick="clearAllFilters()">
                            <i class="fa fa-times"></i> <span data-i18n="cars.clear">Clear</span>
                        </button>
                        <button class="btn btn-apply" onclick="applyMobileFilters()">
                            <i class="fa fa-check"></i> <span data-i18n="cars.apply">Apply</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- content close -->

        <a href="#" id="back-to-top"></a>
        
        <!-- footer begin -->
        <footer class="text-light">
            <div class="container">
                <div class="row g-custom-x">
                    <div class="col-lg-3">
                        <div class="widget">
                            <h5 data-i18n="footer.about_title">About PlusRent</h5>
                            <p data-i18n="footer.about_text">Where quality meets affordability. We understand the importance of a smooth and enjoyable journey without the burden of excessive costs.</p>
                        </div>
                    </div>
                    
                    <div class="col-lg-3">
                        <div class="widget">
                            <h5 data-i18n="footer.contact_title">Contact Info</h5>
                            <address class="s1">
                                <span><i class="id-color fa fa-map-marker fa-lg"></i>Meșterul Manole 20, Chișinău, Moldova</span>
                                <a href="tel:+37360000500"><i class="id-color fa fa-phone fa-lg"></i>+373 60 000 500</a>
                                <span><i class="id-color fa fa-envelope-o fa-lg"></i><a href="mailto:contact@plusrent.md">contact@plusrent.md</a></span>
                            </address>
                        </div>
                    </div>

                    <div class="col-lg-3">
                        <h5 data-i18n="footer.quick_links">Quick Links</h5>
                        <div class="widget">
                            <ul>
                                <li><a href="/" data-i18n="menu.home">Home</a></li>
                                <li><a href="/cars" data-i18n="menu.cars">Cars</a></li>
                                <li><a href="/about" data-i18n="menu.about">About</a></li>
                                <li><a href="/contact" data-i18n="menu.contact">Contact</a></li>
                                <li><a href="/sofer-treaz" data-i18n="menu.sober_driver">Sober Driver</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-lg-3">
                        <div class="widget">
                            <h5 data-i18n="footer.social">Social Network</h5>
                            <div class="social-icons">
                                <a href="https://www.instagram.com/plusrent.md/" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram fa-lg"></i></a>
                                <a href="https://tiktok.me/plusrent" target="_blank" rel="noopener noreferrer"><i class="fab fa-tiktok fa-lg"></i></a>
                            </div>
                        </div>    
                    </div>
                </div>
            </div>
            
            <div class="subfooter">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="de-flex">
                                <div class="de-flex-col">
                                    <a href="/">
                                        Copyright 2025 - PlusRent
                                    </a>
                                </div>
                                <ul class="menu-simple">
                                    <li><a href="/terms" data-i18n="footer.terms">Terms & Conditions</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- footer close -->
    </div>

    <!-- Javascript Files -->
    <script src="js/plugins.js"></script>
    <script src="js/designesia.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
    <!-- Cars Filter Modal JavaScript -->
    <script src="js/cars-filter-modal.js"></script>
    
    <!-- Main Cars Script -->
    <script>
    // Multilingual translations
    const translations = {
        ro: {
            'cars.page_title': 'Flota Noastră',
            'cars.filters': 'Filtre',
            'cars.clear_filters': 'Șterge tot',
            'cars.availability_period': 'Perioada de Disponibilitate',
            'cars.date_from': 'De la',
            'cars.date_to': 'Până la',
            'cars.sort_by': 'Sortează după',
            'cars.sort_default': 'Implicit',
            'cars.sort_price_asc': 'Preț: Crescător',
            'cars.sort_price_desc': 'Preț: Descrescător',
            'cars.price_category': 'Categoria de Preț',
            'cars.all_categories': 'Toate Categoriile',
            'cars.economy': 'Econom',
            'cars.standard': 'Standard',
            'cars.premium': 'Premium',
            'cars.fuel_type': 'Tip Combustibil',
            'cars.gasoline': 'Benzină',
            'cars.diesel': 'Motorină',
            'cars.car_type': 'Tip Mașină',
            'cars.make': 'Marcă',
            'cars.filter_gear': 'Transmisie',
            'cars.passengers': 'Pasageri',
            'cars.filter': 'Filtrează',
            'cars.filter_cars': 'Filtrează Mașini',
            'cars.clear': 'Șterge',
            'cars.apply': 'Aplică',
            'cars.daily_rate': 'Tarif zilnic de la',
            'cars.rent_now': 'Închiriază Acum',
            'cars.no_cars': 'Nu sunt mașini disponibile',
            'footer.about_title': 'Despre PlusRent',
            'footer.about_text': 'Unde calitatea întâlnește accesibilitatea. Înțelegem importanța unei călătorii line și plăcute fără povara costurilor excesive.',
            'footer.contact_title': 'Informații Contact',
            'footer.quick_links': 'Link-uri Rapide',
            'footer.social': 'Rețele Sociale',
            'footer.terms': 'Termeni și Condiții',
            'call_now': 'Sună Acum'
        },
        en: {
            'cars.page_title': 'Our Fleet',
            'cars.filters': 'Filters',
            'cars.clear_filters': 'Clear all',
            'cars.availability_period': 'Availability Period',
            'cars.date_from': 'From',
            'cars.date_to': 'To',
            'cars.sort_by': 'Sort By',
            'cars.sort_default': 'Default',
            'cars.sort_price_asc': 'Price: Low to High',
            'cars.sort_price_desc': 'Price: High to Low',
            'cars.price_category': 'Price Category',
            'cars.all_categories': 'All Categories',
            'cars.economy': 'Economy',
            'cars.standard': 'Standard',
            'cars.premium': 'Premium',
            'cars.fuel_type': 'Fuel Type',
            'cars.gasoline': 'Gasoline',
            'cars.diesel': 'Diesel',
            'cars.car_type': 'Car Type',
            'cars.make': 'Make',
            'cars.filter_gear': 'Transmission',
            'cars.passengers': 'Passengers',
            'cars.filter': 'Filter',
            'cars.filter_cars': 'Filter Cars',
            'cars.clear': 'Clear',
            'cars.apply': 'Apply',
            'cars.daily_rate': 'Daily rate from',
            'cars.rent_now': 'Rent Now',
            'cars.no_cars': 'No cars available',
            'footer.about_title': 'About PlusRent',
            'footer.about_text': 'Where quality meets affordability. We understand the importance of a smooth and enjoyable journey without the burden of excessive costs.',
            'footer.contact_title': 'Contact Info',
            'footer.quick_links': 'Quick Links',
            'footer.social': 'Social Network',
            'footer.terms': 'Terms & Conditions',
            'call_now': 'Call Now'
        },
        ru: {
            'cars.page_title': 'Наш Автопарк',
            'cars.filters': 'Фильтры',
            'cars.clear_filters': 'Очистить все',
            'cars.availability_period': 'Период Доступности',
            'cars.date_from': 'С',
            'cars.date_to': 'До',
            'cars.sort_by': 'Сортировать по',
            'cars.sort_default': 'По умолчанию',
            'cars.sort_price_asc': 'Цена: По возрастанию',
            'cars.sort_price_desc': 'Цена: По убыванию',
            'cars.price_category': 'Категория Цены',
            'cars.all_categories': 'Все Категории',
            'cars.economy': 'Эконом',
            'cars.standard': 'Стандарт',
            'cars.premium': 'Премиум',
            'cars.fuel_type': 'Тип Топлива',
            'cars.gasoline': 'Бензин',
            'cars.diesel': 'Дизель',
            'cars.car_type': 'Тип Автомобиля',
            'cars.make': 'Марка',
            'cars.filter_gear': 'Трансмиссия',
            'cars.passengers': 'Пассажиры',
            'cars.filter': 'Фильтр',
            'cars.filter_cars': 'Фильтровать Машины',
            'cars.clear': 'Очистить',
            'cars.apply': 'Применить',
            'cars.daily_rate': 'Суточный тариф от',
            'cars.rent_now': 'Арендовать',
            'cars.no_cars': 'Нет доступных автомобилей',
            'footer.about_title': 'О PlusRent',
            'footer.about_text': 'Где качество встречается с доступностью. Мы понимаем важность плавного и приятного путешествия без бремени чрезмерных затрат.',
            'footer.contact_title': 'Контактная Информация',
            'footer.quick_links': 'Быстрые Ссылки',
            'footer.social': 'Социальные Сети',
            'footer.terms': 'Условия и Положения',
            'call_now': 'Позвонить'
        }
    };

    // Get current language
    function getCurrentLanguage() {
        return localStorage.getItem('lang') || 'ro';
    }

    // Update text content based on language
    function updatePageTranslations() {
        const lang = getCurrentLanguage();
        const trans = translations[lang] || translations.ro;
        
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (trans[key]) {
                element.textContent = trans[key];
            }
        });
        
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (trans[key]) {
                element.placeholder = trans[key];
            }
        });
    }

    // Translate fuel type
    function translateFuelType(fuel) {
        const lang = getCurrentLanguage();
        const fuelTranslations = {
            'Gasoline': {
                ro: 'Benzină',
                en: 'Gasoline',
                ru: 'Бензин'
            },
            'Diesel': {
                ro: 'Motorină',
                en: 'Diesel',
                ru: 'Дизель'
            }
        };
        return fuelTranslations[fuel]?.[lang] || fuel;
    }

    // Format display text
    function formatDisplayText(rawKey) {
        if (!rawKey) return '';
        // Convert to string first to handle any data type
        const text = String(rawKey);
        return text
            .split('_')
            .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
            .join(' ');
    }

    // Global variables
    let allCarsCache = [];
    let priceFilterSettings = {
        economy: { min: 0, max: 30 },
        standard: { min: 31, max: 60 },
        premium: { min: 61, max: 999 }
    };

    // Load price filter settings from API
    async function loadPriceFilterSettings() {
        try {
            const response = await fetch(`${window.API_BASE_URL}/api/fee-settings/public`);
            if (response.ok) {
                const feeSettings = await response.json();
                priceFilterSettings = {
                    economy: {
                        min: feeSettings.economy_price_min ?? 0,
                        max: feeSettings.economy_price_max ?? 30
                    },
                    standard: {
                        min: feeSettings.standard_price_min ?? 31,
                        max: feeSettings.standard_price_max ?? 60
                    },
                    premium: {
                        min: feeSettings.premium_price_min ?? 61,
                        max: feeSettings.premium_price_max ?? 999
                    }
                };
            }
        } catch (error) {
            console.error('Error loading price settings:', error);
        }
    }

    // Initialize date pickers
    function initializeDatePickers() {
        const lang = getCurrentLanguage();
        
        // Configure Flatpickr options
        let flatpickrConfig = {
            dateFormat: "d.m.Y",
            minDate: "today",
            onChange: function(selectedDates, dateStr, instance) {
                if (instance.element.id === 'date-from') {
                    const dateTo = document.querySelector('#date-to')?._flatpickr;
                    if (dateTo) {
                        dateTo.set('minDate', dateStr);
                    }
                }
                updateFiltersAndFetch();
            }
        };
        
        // Add Russian locale if needed
        if (lang === 'ru' && typeof flatpickr.l10ns.ru !== 'undefined') {
            flatpickrConfig.locale = flatpickr.l10ns.ru;
        }
        
        // Initialize desktop date pickers
        if (document.querySelector("#date-from")) {
            flatpickr("#date-from", flatpickrConfig);
        }
        if (document.querySelector("#date-to")) {
            flatpickr("#date-to", flatpickrConfig);
        }
        
        // Mobile date pickers config
        let mobileFlatpickrConfig = {
            dateFormat: "d.m.Y",
            minDate: "today",
            onChange: function(selectedDates, dateStr, instance) {
                if (instance.element.id === 'mobile-date-from') {
                    const dateTo = document.querySelector('#mobile-date-to')?._flatpickr;
                    if (dateTo) {
                        dateTo.set('minDate', dateStr);
                    }
                }
            }
        };
        
        if (lang === 'ru' && typeof flatpickr.l10ns.ru !== 'undefined') {
            mobileFlatpickrConfig.locale = flatpickr.l10ns.ru;
        }
        
        // Initialize mobile date pickers
        if (document.querySelector("#mobile-date-from")) {
            flatpickr("#mobile-date-from", mobileFlatpickrConfig);
        }
        if (document.querySelector("#mobile-date-to")) {
            flatpickr("#mobile-date-to", mobileFlatpickrConfig);
        }
    }

    // Get unique options for filters
    function getUniqueOptions(cars, field) {
        return Array.from(new Set(cars.map(car => car[field]).filter(Boolean))).sort();
    }

    // Render filter options
    function renderFilterOptions(containerId, options, selectedValues, allCars, currentFilters, field) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        const countCache = new Map();
        
        if (allCars && allCars.length > 0) {
            options.forEach(opt => {
                const count = allCars.filter(car => {
                    if (String(car[field]) !== String(opt)) return false;
                    
                    for (const key in currentFilters) {
                        if (key === field) continue;
                        if (!currentFilters[key] || !currentFilters[key].length) continue;
                        if (!currentFilters[key].includes(String(car[key]))) return false;
                    }
                    return true;
                }).length;
                countCache.set(opt, count);
            });
        }
        
        const html = options.map(opt => {
            const count = countCache.get(opt) || 0;
            const isSelected = selectedValues.includes(String(opt));
            const isDisabled = count === 0 && !isSelected;
            
            // Translate fuel type if needed
            let displayName = opt;
            if (field === 'fuel_type') {
                displayName = translateFuelType(opt);
            } else {
                displayName = formatDisplayText(opt);
            }
            
            return `
                <div class="filter-option-row ${isDisabled ? 'disabled-option' : ''}">
                    <label>
                        <input type="checkbox" value="${opt}" ${isSelected ? 'checked' : ''} ${isDisabled ? 'disabled' : ''}>
                        <span class="option-label">${displayName}</span>
                    </label>
                    <span class="option-count">${count}</span>
                </div>
            `;
        }).join('');
        
        container.innerHTML = html;
    }

    // Get selected values from checkboxes
    function getSelectedValues(containerId) {
        return Array.from(document.querySelectorAll(`#${containerId} input[type=checkbox]:checked`))
            .map(cb => cb.value);
    }

    // Update filters and fetch cars with modal sync
    function updateFiltersAndFetch() {
        const params = new URLSearchParams();
        
        // Collect filter values
        const make = getSelectedValues('filter-make-options');
        const gear = getSelectedValues('filter-gear-options');
        const fuel = getSelectedValues('filter-fuel-options');
        const type = getSelectedValues('filter-type-options');
        const passengers = getSelectedValues('filter-passengers-options');
        
        // Date filters
        const dateFrom = document.getElementById('date-from')?.value;
        const dateTo = document.getElementById('date-to')?.value;
        
        // Sort option
        const sortBy = document.getElementById('sort-select')?.value;
        
        // Price category
        const priceCategory = document.querySelector('input[name="price-category"]:checked')?.value;
        
        // Build query params
        if (make.length) params.set('make_name', make.join(','));
        if (gear.length) params.set('gear_type', gear.join(','));
        if (fuel.length) params.set('fuel_type', fuel.join(','));
        if (type.length) params.set('car_type', type.join(','));
        if (passengers.length) params.set('num_passengers', passengers.join(','));
        if (dateFrom) params.set('date_from', dateFrom);
        if (dateTo) params.set('date_to', dateTo);
        if (sortBy && sortBy !== 'default') params.set('sort', sortBy);
        
        // Handle price category and sync with modal
        if (priceCategory && priceCategory !== 'all') {
            const settings = priceFilterSettings[priceCategory];
            if (settings) {
                params.set('min_price', settings.min);
                params.set('max_price', settings.max);
                
                // Update the modal filter if it exists
                if (window.carsFilterModal && window.carsFilterModal.modal) {
                    // Remove active class from all cards
                    window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    // Add active class to selected category
                    const selectedCard = window.carsFilterModal.modal.querySelector(`.filter-card[data-filter="${priceCategory === 'economy' ? 'econom' : priceCategory}"]`);
                    if (selectedCard) {
                        selectedCard.classList.add('selected');
                    }
                }
            }
        } else {
            // If "all" is selected, update modal
            if (window.carsFilterModal && window.carsFilterModal.modal) {
                window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                    card.classList.remove('selected');
                });
                const allCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="all"]');
                if (allCard) {
                    allCard.classList.add('selected');
                }
            }
        }
        
        // Update URL
        const newUrl = window.location.pathname + (params.toString() ? '?' + params.toString() : '');
        window.history.pushState({}, '', newUrl);
        
        // Fetch and render
        fetchAndRenderCars();
    }

    // Make updateFiltersAndFetch available globally for modal
    window.updateFiltersAndFetch = updateFiltersAndFetch;

    // Sync function to be called from cars-filter-modal
    window.syncFiltersWithModal = function(priceCategory) {
        // Update the filter radio buttons based on modal selection
        const radioButtons = document.querySelectorAll('input[name="price-category"]');
        radioButtons.forEach(radio => {
            radio.checked = radio.value === priceCategory;
        });
        
        // Update mobile filter radio buttons too
        const mobileRadioButtons = document.querySelectorAll('input[name="mobile-price-category"]');
        mobileRadioButtons.forEach(radio => {
            radio.checked = radio.value === priceCategory;
        });
        
        // Apply the filter
        updateFiltersAndFetch();
    };

    // Fetch and render cars
    async function fetchAndRenderCars() {
        const carListDiv = document.getElementById('car-list');
        carListDiv.innerHTML = '<div class="loading-spinner"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div></div>';
        
        try {
            const res = await fetch(`${window.API_BASE_URL}/api/cars${window.location.search}`);
            const cars = await res.json();
            
            if (!cars.length) {
                carListDiv.innerHTML = `<div class="col-12 text-center py-5"><h3 data-i18n="cars.no_cars">No cars available</h3></div>`;
                updatePageTranslations();
                return;
            }
            
            // Sort cars if needed
            const sortBy = new URLSearchParams(window.location.search).get('sort');
            if (sortBy) {
                cars.sort((a, b) => {
                    const priceA = getLowestPrice(a);
                    const priceB = getLowestPrice(b);
                    
                    if (sortBy === 'price_asc') {
                        return priceA - priceB;
                    } else if (sortBy === 'price_desc') {
                        return priceB - priceA;
                    }
                    return 0;
                });
            }
            
            const lang = getCurrentLanguage();
            const carsHtml = cars.map(car => {
                const isPremium = car.is_premium === 1 || car.is_premium === true;
                const rentNowUrl = `car-single.html?id=${car.id}`;
                const lowestPrice = getLowestPrice(car);
                
                return `
                    <div class="col-xl-4 col-lg-6 col-md-6 col-12 mb-4">
                        <div class="car-card ${isPremium ? 'premium' : ''}">
                            <div class="car-image-wrapper">
                                <img src="${getCarImage(car)}" class="car-image" alt="${car.make_name} ${car.model_name}">
                                ${isPremium ? '<div class="premium-badge">HOT</div>' : ''}
                            </div>
                            <div class="car-details">
                                <h4 class="car-title">${formatDisplayText(car.make_name)}</h4>
                                <p class="car-model">${formatDisplayText(car.model_name)}</p>
                                <div class="car-features">
                                    <div class="car-feature">
                                        <i class="fa fa-users"></i>
                                        <span>${car.num_passengers || '-'} ${lang === 'ro' ? 'locuri' : lang === 'ru' ? 'мест' : 'seats'}</span>
                                    </div>
                                    <div class="car-feature">
                                        <i class="fa fa-suitcase"></i>
                                        <span>${car.luggage || '-'} ${lang === 'ro' ? 'bagaje' : lang === 'ru' ? 'багаж' : 'luggage'}</span>
                                    </div>
                                    <div class="car-feature">
                                        <i class="fa fa-gas-pump"></i>
                                        <span>${translateFuelType(car.fuel_type)}</span>
                                    </div>
                                    <div class="car-feature">
                                        <i class="fa fa-cog"></i>
                                        <span>${car.gear_type || 'Manual'}</span>
                                    </div>
                                </div>
                                <div class="car-price">
                                    <span class="price-label" data-i18n="cars.daily_rate">Daily rate from</span>
                                    <span class="price-value">€${lowestPrice}</span>
                                </div>
                                <a href="${rentNowUrl}" class="btn-rent" data-i18n="cars.rent_now">Rent Now</a>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            carListDiv.innerHTML = carsHtml;
            updatePageTranslations();
            renderSidebarOptions();
            
        } catch (error) {
            console.error('Error fetching cars:', error);
            carListDiv.innerHTML = '<div class="col-12 text-center py-5"><h3>Error loading cars</h3></div>';
        }
    }

    // Get lowest price from car
    function getLowestPrice(car) {
        if (car.price_policy) {
            const pricePolicy = typeof car.price_policy === 'string' ? 
                JSON.parse(car.price_policy) : car.price_policy;
            const prices = Object.values(pricePolicy).map(p => parseInt(p));
            return Math.min(...prices);
        }
        return 0;
    }

    // Get car image URL
    function getCarImage(car) {
        if (car.head_image && car.head_image.startsWith('http')) {
            return car.head_image;
        }
        return car.head_image ? 
            window.API_BASE_URL + car.head_image : 
            window.API_BASE_URL + '/uploads/placeholder.png';
    }

    // Render sidebar options
    function renderSidebarOptions() {
        const params = new URLSearchParams(window.location.search);
        const currentFilters = {
            make_name: params.get('make_name')?.split(',') || [],
            gear_type: params.get('gear_type')?.split(',') || [],
            fuel_type: params.get('fuel_type')?.split(',') || [],
            car_type: params.get('car_type')?.split(',') || [],
            num_passengers: params.get('num_passengers')?.split(',') || []
        };
        
        // Get price params
        const minPrice = params.get('min_price');
        const maxPrice = params.get('max_price');
        
        // Filter fuel types to only show Gasoline and Diesel
        const fuelTypes = ['Gasoline', 'Diesel'];
        const carTypes = ['Sedan', 'Suv', 'Crossover', 'Hatchback'];
        
        renderFilterOptions('filter-fuel-options', fuelTypes, currentFilters.fuel_type, allCarsCache, currentFilters, 'fuel_type');
        renderFilterOptions('filter-type-options', carTypes, currentFilters.car_type, allCarsCache, currentFilters, 'car_type');
        renderFilterOptions('filter-make-options', getUniqueOptions(allCarsCache, 'make_name'), currentFilters.make_name, allCarsCache, currentFilters, 'make_name');
        renderFilterOptions('filter-gear-options', getUniqueOptions(allCarsCache, 'gear_type'), currentFilters.gear_type, allCarsCache, currentFilters, 'gear_type');
        renderFilterOptions('filter-passengers-options', getUniqueOptions(allCarsCache, 'num_passengers'), currentFilters.num_passengers, allCarsCache, currentFilters, 'num_passengers');
        
        // Set price category radio based on URL params
        const priceCategoryRadios = document.querySelectorAll('input[name="price-category"]');
        priceCategoryRadios.forEach(radio => {
            radio.checked = false;
        });
        
        // Determine which category matches the current price range
        if (minPrice && maxPrice) {
            if (minPrice == priceFilterSettings.economy.min && maxPrice == priceFilterSettings.economy.max) {
                const economyRadio = document.querySelector('input[name="price-category"][value="economy"]');
                if (economyRadio) economyRadio.checked = true;
                
                // Sync with modal
                if (window.carsFilterModal && window.carsFilterModal.modal) {
                    window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    const economCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="econom"]');
                    if (economCard) economCard.classList.add('selected');
                }
            } else if (minPrice == priceFilterSettings.standard.min && maxPrice == priceFilterSettings.standard.max) {
                const standardRadio = document.querySelector('input[name="price-category"][value="standard"]');
                if (standardRadio) standardRadio.checked = true;
                
                // Sync with modal
                if (window.carsFilterModal && window.carsFilterModal.modal) {
                    window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    const standardCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="standard"]');
                    if (standardCard) standardCard.classList.add('selected');
                }
            } else if (minPrice == priceFilterSettings.premium.min && maxPrice == priceFilterSettings.premium.max) {
                const premiumRadio = document.querySelector('input[name="price-category"][value="premium"]');
                if (premiumRadio) premiumRadio.checked = true;
                
                // Sync with modal
                if (window.carsFilterModal && window.carsFilterModal.modal) {
                    window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    const premiumCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="premium"]');
                    if (premiumCard) premiumCard.classList.add('selected');
                }
            }
        } else {
            // No price filter - select "All"
            const allRadio = document.querySelector('input[name="price-category"][value="all"]');
            if (allRadio) allRadio.checked = true;
            
            // Sync with modal
            if (window.carsFilterModal && window.carsFilterModal.modal) {
                window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                    card.classList.remove('selected');
                });
                const allCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="all"]');
                if (allCard) allCard.classList.add('selected');
            }
        }
        
        // Attach event listeners
        document.querySelectorAll('.filter-sidebar input[type=checkbox]').forEach(cb => {
            cb.addEventListener('change', updateFiltersAndFetch);
        });
        
        // Price category listeners with modal sync
        document.querySelectorAll('input[name="price-category"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                const category = e.target.value;
                
                // Update modal visual state
                if (window.carsFilterModal && window.carsFilterModal.modal) {
                    window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    
                    let filterValue = category;
                    if (category === 'economy') filterValue = 'econom';
                    
                    const selectedCard = window.carsFilterModal.modal.querySelector(`.filter-card[data-filter="${filterValue}"]`);
                    if (selectedCard) {
                        selectedCard.classList.add('selected');
                    }
                }
                
                updateFiltersAndFetch();
            });
        });
        
        // Sort listener
        document.getElementById('sort-select')?.addEventListener('change', updateFiltersAndFetch);
    }

    // Mobile filter functions with fixed scrolling
    function toggleMobileFilter() {
        const overlay = document.getElementById('mobile-filter-overlay');
        if (!overlay) return;
        
        if (overlay.classList.contains('active')) {
            overlay.classList.remove('active');
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
            document.body.style.top = '';
            // Restore scroll position
            const scrollY = document.body.style.top;
            window.scrollTo(0, parseInt(scrollY || '0') * -1);
        } else {
            // Save scroll position and lock body
            const scrollY = window.scrollY;
            overlay.classList.add('active');
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.width = '100%';
            document.body.style.overflow = 'hidden';
            renderMobileFilterOptions();
        }
    }

    function renderMobileFilterOptions() {
        const container = document.getElementById('mobile-filter-options');
        if (!container) return;
        
        const lang = getCurrentLanguage();
        const trans = translations[lang] || translations.ro;
        
        container.innerHTML = `
            <!-- Date Range -->
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.availability_period']}</h6>
                <div class="date-input-group">
                    <div class="date-input-wrapper">
                        <input type="text" id="mobile-date-from" placeholder="${trans['cars.date_from']}">
                        <i class="fa fa-calendar icon"></i>
                    </div>
                    <span>-</span>
                    <div class="date-input-wrapper">
                        <input type="text" id="mobile-date-to" placeholder="${trans['cars.date_to']}">
                        <i class="fa fa-calendar icon"></i>
                    </div>
                </div>
            </div>
            
            <div class="filter-divider"></div>
            
            <!-- Sort Options -->
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.sort_by']}</h6>
                <select id="mobile-sort-select" class="sort-select">
                    <option value="default">${trans['cars.sort_default']}</option>
                    <option value="price_asc">${trans['cars.sort_price_asc']}</option>
                    <option value="price_desc">${trans['cars.sort_price_desc']}</option>
                </select>
            </div>
            
            <div class="filter-divider"></div>
            
            <!-- Price Category -->
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.price_category']}</h6>
                <div class="filter-option-row">
                    <label>
                        <input type="radio" name="mobile-price-category" value="all" checked>
                        <span class="option-label">${trans['cars.all_categories']}</span>
                    </label>
                </div>
                <div class="filter-option-row">
                    <label>
                        <input type="radio" name="mobile-price-category" value="economy">
                        <span class="option-label">${trans['cars.economy']}</span>
                    </label>
                </div>
                <div class="filter-option-row">
                    <label>
                        <input type="radio" name="mobile-price-category" value="standard">
                        <span class="option-label">${trans['cars.standard']}</span>
                    </label>
                </div>
                <div class="filter-option-row">
                    <label>
                        <input type="radio" name="mobile-price-category" value="premium">
                        <span class="option-label">${trans['cars.premium']}</span>
                    </label>
                </div>
            </div>
            
            <div class="filter-divider"></div>
            
            <!-- Other filters -->
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.fuel_type']}</h6>
                <div id="mobile-filter-fuel-options"></div>
            </div>
            
            <div class="filter-divider"></div>
            
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.car_type']}</h6>
                <div id="mobile-filter-type-options"></div>
            </div>
            
            <div class="filter-divider"></div>
            
            <div class="filter-category">
                <h6 class="filter-section-title">${trans['cars.make']}</h6>
                <div id="mobile-filter-make-options"></div>
            </div>
        `;
        
        // Render mobile filter options
        const params = new URLSearchParams(window.location.search);
        const currentFilters = {
            fuel_type: params.get('fuel_type')?.split(',') || [],
            car_type: params.get('car_type')?.split(',') || [],
            make_name: params.get('make_name')?.split(',') || []
        };
        
        const fuelTypes = ['Gasoline', 'Diesel'];
        const carTypes = ['Sedan', 'Suv', 'Crossover', 'Hatchback'];
        
        renderFilterOptions('mobile-filter-fuel-options', fuelTypes, currentFilters.fuel_type, allCarsCache, currentFilters, 'fuel_type');
        renderFilterOptions('mobile-filter-type-options', carTypes, currentFilters.car_type, allCarsCache, currentFilters, 'car_type');
        renderFilterOptions('mobile-filter-make-options', getUniqueOptions(allCarsCache, 'make_name'), currentFilters.make_name, allCarsCache, currentFilters, 'make_name');
        
        // Initialize mobile date pickers
        initializeDatePickers();
    }

    function applyMobileFilters() {
        // Sync mobile filters to desktop
        const mobileValues = {
            fuel: getSelectedValues('mobile-filter-fuel-options'),
            type: getSelectedValues('mobile-filter-type-options'),
            make: getSelectedValues('mobile-filter-make-options'),
            dateFrom: document.getElementById('mobile-date-from')?.value,
            dateTo: document.getElementById('mobile-date-to')?.value,
            sort: document.getElementById('mobile-sort-select')?.value,
            priceCategory: document.querySelector('input[name="mobile-price-category"]:checked')?.value
        };
        
        // Build params
        const params = new URLSearchParams();
        if (mobileValues.fuel.length) params.set('fuel_type', mobileValues.fuel.join(','));
        if (mobileValues.type.length) params.set('car_type', mobileValues.type.join(','));
        if (mobileValues.make.length) params.set('make_name', mobileValues.make.join(','));
        if (mobileValues.dateFrom) params.set('date_from', mobileValues.dateFrom);
        if (mobileValues.dateTo) params.set('date_to', mobileValues.dateTo);
        if (mobileValues.sort && mobileValues.sort !== 'default') params.set('sort', mobileValues.sort);
        
        if (mobileValues.priceCategory && mobileValues.priceCategory !== 'all') {
            const settings = priceFilterSettings[mobileValues.priceCategory];
            if (settings) {
                params.set('min_price', settings.min);
                params.set('max_price', settings.max);
            }
        }
        
        // Update URL and fetch
        const newUrl = window.location.pathname + (params.toString() ? '?' + params.toString() : '');
        window.history.pushState({}, '', newUrl);
        fetchAndRenderCars();
        toggleMobileFilter();
    }

    function clearAllFilters() {
        document.querySelectorAll('#mobile-filter-overlay input[type=checkbox]').forEach(cb => cb.checked = false);
        document.querySelectorAll('#mobile-filter-overlay input[type=radio][value="all"]').forEach(radio => radio.checked = true);
        document.getElementById('mobile-date-from').value = '';
        document.getElementById('mobile-date-to').value = '';
        document.getElementById('mobile-sort-select').value = 'default';
    }

    // Language switcher
    function initLanguageSwitcher() {
        const langBtn = document.getElementById('langPickerBtn');
        const langDropdown = document.getElementById('langDropdown');
        const langFlag = document.getElementById('langFlag');
        const langCode = document.getElementById('langCode');
        
        const currentLang = getCurrentLanguage();
        updateLanguageDisplay(currentLang);
        
        langBtn?.addEventListener('click', (e) => {
            e.stopPropagation();
            langDropdown.classList.toggle('open');
        });
        
        document.querySelectorAll('.lang-option').forEach(option => {
            option.addEventListener('click', (e) => {
                const lang = e.currentTarget.getAttribute('data-lang');
                localStorage.setItem('lang', lang);
                updateLanguageDisplay(lang);
                langDropdown.classList.remove('open');
                updatePageTranslations();
                initializeDatePickers(); // Reinit with new locale
                fetchAndRenderCars(); // Refresh cars with new translations
            });
        });
        
        document.addEventListener('click', () => {
            langDropdown?.classList.remove('open');
        });
    }

    function updateLanguageDisplay(lang) {
        const langFlag = document.getElementById('langFlag');
        const langCode = document.getElementById('langCode');
        
        const flags = {
            ro: 'images/flags/romania.png',
            en: 'images/flags/united-kingdom.png',
            ru: 'images/flags/russia.png'
        };
        
        const codes = {
            ro: 'RO',
            en: 'EN',
            ru: 'RU'
        };
        
        if (langFlag && flags[lang]) {
            langFlag.innerHTML = `<img src="${flags[lang]}" alt="${codes[lang]}">`;
        }
        if (langCode && codes[lang]) {
            langCode.textContent = codes[lang];
        }
        
        // Update selected state
        document.querySelectorAll('.lang-option').forEach(option => {
            option.classList.toggle('selected', option.getAttribute('data-lang') === lang);
        });
    }

    // Initialize everything
    async function initialize() {
        // First, make functions globally available for modal
        window.updateFiltersAndFetch = updateFiltersAndFetch;
        window.fetchAndRenderCars = fetchAndRenderCars;
        
        await loadPriceFilterSettings();
        
        // Load all cars for filter counts
        try {
            const res = await fetch(`${window.API_BASE_URL}/api/cars`);
            allCarsCache = await res.json();
        } catch (error) {
            console.error('Error loading cars cache:', error);
        }
        
        initLanguageSwitcher();
        updatePageTranslations();
        initializeDatePickers();
        fetchAndRenderCars();
        
        // Clear filters button
        document.getElementById('clear-filters-link')?.addEventListener('click', (e) => {
            e.preventDefault();
            window.history.pushState({}, '', window.location.pathname);
            
            // Clear all filter inputs
            clearAllFilters();
            
            // Fetch cars without filters
            fetchAndRenderCars();
            
            // Sync with modal - set to "all"
            if (window.carsFilterModal && window.carsFilterModal.modal) {
                window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                    card.classList.remove('selected');
                });
                const allCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="all"]');
                if (allCard) {
                    allCard.classList.add('selected');
                }
            }
        });
        
        // Mobile filter overlay click outside
        document.getElementById('mobile-filter-overlay')?.addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                toggleMobileFilter();
            }
        });
        
        // Check URL parameters on load to sync with modal
        const params = new URLSearchParams(window.location.search);
        const minPrice = params.get('min_price');
        const maxPrice = params.get('max_price');
        
        // Wait a bit for modal to be ready, then sync
        setTimeout(() => {
            if (minPrice && maxPrice && window.carsFilterModal && window.carsFilterModal.modal) {
                // Determine which category is selected based on prices
                window.carsFilterModal.modal.querySelectorAll('.filter-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                if (minPrice == priceFilterSettings.economy.min && maxPrice == priceFilterSettings.economy.max) {
                    const economCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="econom"]');
                    if (economCard) economCard.classList.add('selected');
                } else if (minPrice == priceFilterSettings.standard.min && maxPrice == priceFilterSettings.standard.max) {
                    const standardCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="standard"]');
                    if (standardCard) standardCard.classList.add('selected');
                } else if (minPrice == priceFilterSettings.premium.min && maxPrice == priceFilterSettings.premium.max) {
                    const premiumCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="premium"]');
                    if (premiumCard) premiumCard.classList.add('selected');
                }
            } else if (!minPrice && !maxPrice && window.carsFilterModal && window.carsFilterModal.modal) {
                // No price filter - select "All"
                const allCard = window.carsFilterModal.modal.querySelector('.filter-card[data-filter="all"]');
                if (allCard) allCard.classList.add('selected');
            }
        }, 500);
    }

    // Start when DOM is ready
    document.addEventListener('DOMContentLoaded', initialize);

    // Export functions for global use
    window.toggleMobileFilter = toggleMobileFilter;
    window.applyMobileFilters = applyMobileFilters;
    window.clearAllFilters = clearAllFilters;
    window.fetchAndRenderCars = fetchAndRenderCars;
    window.updateFiltersAndFetch = updateFiltersAndFetch;
    window.applyModalFilter = applyModalFilter;
    
    // Override the modal's update function if needed
    document.addEventListener('DOMContentLoaded', function() {
        // Wait for modal to be initialized
        setTimeout(() => {
            if (window.carsFilterModal) {
                // Override the modal's updateCarList method to use our function
                const originalUpdateCarList = window.carsFilterModal.updateCarList;
                window.carsFilterModal.updateCarList = function() {
                    // Get the current filter values from modal
                    const minPrice = document.getElementById('filter-price-min')?.value;
                    const maxPrice = document.getElementById('filter-price-max')?.value;
                    
                    // Determine which category was selected based on prices
                    let filterType = 'all';
                    if (minPrice && maxPrice) {
                        if (minPrice == priceFilterSettings.economy.min && maxPrice == priceFilterSettings.economy.max) {
                            filterType = 'econom';
                        } else if (minPrice == priceFilterSettings.standard.min && maxPrice == priceFilterSettings.standard.max) {
                            filterType = 'standard';
                        } else if (minPrice == priceFilterSettings.premium.min && maxPrice == priceFilterSettings.premium.max) {
                            filterType = 'premium';
                        }
                    }
                    
                    // Apply the filter through our system
                    window.applyModalFilter(filterType);
                };
            }
        }, 300);
    });
    </script>
</body>
</html>
