<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter Modal Debug</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/mdb.min.css" rel="stylesheet">
    <link href="css/plugins.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/coloring.css" rel="stylesheet">
    <link href="css/colors/scheme-01.css" rel="stylesheet">
    <link href="css/cars-filter-modal.css" rel="stylesheet">
    <script src="js/config.js"></script>
    <script src="https://unpkg.com/i18next@21.6.14/dist/umd/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-http-backend@1.4.3/i18nextHttpBackend.min.js"></script>
    <script src="js/i18n-init.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>Filter Modal Debug</h1>
        <p>This page helps debug the filter modal functionality.</p>
        
        <div class="row">
            <div class="col-md-6">
                <h3>Controls</h3>
                <button id="test-modal-btn" class="btn btn-primary mb-2">Open Filter Modal</button><br>
                <button id="test-filter-btn" class="btn btn-info mb-2">Test Filter Application</button><br>
                <button id="check-functions-btn" class="btn btn-secondary mb-2">Check Available Functions</button>
            </div>
            
            <div class="col-md-6">
                <h3>Current Price Filters</h3>
                <div id="current-filters">
                    <p>No filters applied</p>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>Debug Console</h3>
            <div id="debug-console" style="background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; max-height: 300px; overflow-y: auto;">
                <p>Debug messages will appear here...</p>
            </div>
        </div>
        
        <div class="mt-4">
            <h3>Mock Car Data</h3>
            <div id="mock-cars"></div>
        </div>
    </div>

    <script src="js/plugins.js"></script>
    <script src="js/designesia.js"></script>
    <script src="js/cars-filter-modal.js"></script>
    
    <script>
        // Mock car data
        const mockCars = [
            { id: 1, make_name: 'BMW', model_name: 'X5', price_policy: { '1-2': 25 } },
            { id: 2, make_name: 'Mercedes', model_name: 'C-Class', price_policy: { '1-2': 45 } },
            { id: 3, make_name: 'Audi', model_name: 'A4', price_policy: { '1-2': 75 } },
            { id: 4, make_name: 'Toyota', model_name: 'Camry', price_policy: { '1-2': 35 } }
        ];
        
        // Debug logging function
        function debugLog(message) {
            const console = document.getElementById('debug-console');
            const timestamp = new Date().toLocaleTimeString();
            console.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }
        
        // Mock updateFiltersAndFetch function
        window.updateFiltersAndFetch = function() {
            debugLog('‚úÖ updateFiltersAndFetch called successfully');
            updateCurrentFilters();
        };
        
        // Mock fetchAndRenderCars function
        window.fetchAndRenderCars = function() {
            debugLog('‚úÖ fetchAndRenderCars called successfully');
            updateCurrentFilters();
        };
        
        function updateCurrentFilters() {
            const currentFilters = document.getElementById('current-filters');
            const minPrice = document.getElementById('filter-price-min')?.value || '';
            const maxPrice = document.getElementById('filter-price-max')?.value || '';
            
            if (minPrice || maxPrice) {
                currentFilters.innerHTML = `
                    <p><strong>Price Range:</strong> ${minPrice ? minPrice + ' EUR' : '0 EUR'} - ${maxPrice ? maxPrice + ' EUR' : '‚àû'}</p>
                `;
            } else {
                currentFilters.innerHTML = '<p>No filters applied</p>';
            }
        }
        
        function displayMockCars() {
            const mockCarsDiv = document.getElementById('mock-cars');
            mockCarsDiv.innerHTML = mockCars.map(car => `
                <div class="card mb-2">
                    <div class="card-body">
                        <h5 class="card-title">${car.make_name} ${car.model_name}</h5>
                        <p class="card-text">Price: ${car.price_policy['1-2']} EUR</p>
                    </div>
                </div>
            `).join('');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('üöÄ Page loaded, initializing...');
            
            // Display mock cars
            displayMockCars();
            
            // Test modal functionality
            document.getElementById('test-modal-btn').addEventListener('click', function() {
                debugLog('üîç Testing modal opening...');
                if (window.carsFilterModal) {
                    window.carsFilterModal.show();
                    debugLog('‚úÖ Modal opened successfully');
                } else {
                    debugLog('‚ùå Modal not found');
                }
            });
            
            // Test filter application
            document.getElementById('test-filter-btn').addEventListener('click', function() {
                debugLog('üîç Testing filter application...');
                if (window.carsFilterModal) {
                    window.carsFilterModal.applyFilter('econom');
                    debugLog('‚úÖ Filter applied successfully');
                } else {
                    debugLog('‚ùå Modal not found');
                }
            });
            
            // Check available functions
            document.getElementById('check-functions-btn').addEventListener('click', function() {
                debugLog('üîç Checking available functions...');
                debugLog(`updateFiltersAndFetch: ${typeof updateFiltersAndFetch}`);
                debugLog(`fetchAndRenderCars: ${typeof fetchAndRenderCars}`);
                debugLog(`carsFilterModal: ${typeof window.carsFilterModal}`);
                debugLog(`updateContent: ${typeof updateContent}`);
            });
            
            // Check if modal was created
            setTimeout(() => {
                if (window.carsFilterModal) {
                    debugLog('‚úÖ Filter modal initialized successfully');
                } else {
                    debugLog('‚ùå Filter modal failed to initialize');
                }
            }, 2000);
        });
    </script>
</body>
</html> 