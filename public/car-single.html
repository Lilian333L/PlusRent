<!DOCTYPE html>
<html lang="ro">
<head>
  <title>Detalii mașină | PlusRent – Închirieri Auto Chișinău</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="images/icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
  <link rel="shortcut icon" type="image/png" href="images/icon.png">
  
  <!-- Meta Base -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#ffffff">
  <meta name="msapplication-TileImage" content="images/icon.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  
  <!-- SEO -->
  <meta name="description" content="Detalii complete despre mașina selectată din flota PlusRent. Alege modelul potrivit și rezervă-l online rapid și sigur.">
  <meta name="author" content="PlusRent.md">
  <meta name="robots" content="index, follow">
  
  <!-- Canonical -->
  <link rel="canonical" href="https://plusrent.md/car-single">
  
  <!-- Open Graph -->
  <meta property="og:type" content="product">
  <meta property="og:title" content="Detalii mașină | PlusRent">
  <meta property="og:description" content="Vezi detalii complete și rezervă această mașină din flota PlusRent.">
  <meta property="og:image" content="https://plusrent.md/images/LOGO-5-demo.png">
  <meta property="og:url" content="https://plusrent.md/car-single">
  <meta property="og:site_name" content="PlusRent">
  <meta property="og:locale" content="ro_RO">
  <meta property="og:locale:alternate" content="ru_RU">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Detalii mașină | PlusRent">
  <meta name="twitter:description" content="Vezi detalii complete și rezervă această mașină.">
  <meta name="twitter:image" content="https://plusrent.md/images/LOGO-5-demo.png">

  <!-- Car Meta Updater -->
  <script src="js/car-meta-updater.js"></script>
  
  <!-- CSS Files -->
  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap">
  <link href="css/mdb.min.css" rel="stylesheet" type="text/css" id="mdb">
  <link href="css/plugins.css" rel="stylesheet" type="text/css">
  <link href="css/style.css" rel="stylesheet" type="text/css">
  <link href="css/coloring.css" rel="stylesheet" type="text/css">
  <link id="colors" href="css/colors/scheme-01.css" rel="stylesheet" type="text/css">
  
  <!-- FontAwesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  
  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  
  <!-- API Configuration -->
  <script>
    window.API_BASE_URL = '';
  </script>
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json" id="car-schema">
  {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "Mașină de închiriat",
    "description": "Închiriază această mașină cu PlusRent",
    "brand": {
      "@type": "Brand",
      "name": "PlusRent"
    },
    "offers": {
      "@type": "Offer",
      "availability": "https://schema.org/InStock",
      "price": "25",
      "priceCurrency": "EUR",
      "priceValidUntil": "2025-12-31",
      "seller": {
        "@type": "Organization",
        "name": "PlusRent",
        "url": "https://plusrent.md",
        "telephone": "+373-60-000-500"
      }
    },
    "image": "https://plusrent.md/images/LOGO-5-demo.png"
  }
  </script>

<style>
/* ============================================
   PROFESSIONAL CAR RENTAL DESIGN 2025
   Чистый, Современный, Оптимизированный
   ============================================ */

/* Custom carousel styles */
.custom-carousel {
  position: relative;
  overflow: hidden;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
}

.custom-carousel-main {
  position: relative;
  height: 450px;
  background: #f8f9fa;
  overflow: hidden;
  cursor: pointer;
}

.custom-carousel-main img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
  transition: transform 0.5s ease;
}

.custom-carousel-main img.active {
  display: block;
  animation: smoothZoom 0.6s ease;
}

@keyframes smoothZoom {
  from {
    opacity: 0.7;
    transform: scale(1.05);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.custom-carousel-nav {
  display: flex;
  gap: 12px;
  margin-top: 20px;
  justify-content: flex-start;
  overflow-x: auto;
  padding: 10px 5px;
  scrollbar-width: none;
}

.custom-carousel-nav::-webkit-scrollbar {
  display: none;
}

.custom-carousel-nav img {
  width: 100px;
  height: 75px;
  object-fit: cover;
  cursor: pointer;
  border: 3px solid transparent;
  border-radius: 12px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  flex-shrink: 0;
  opacity: 0.6;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.custom-carousel-nav img.active {
  border-color: #2196F3;
  opacity: 1;
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(33, 150, 243, 0.3);
}

.custom-carousel-nav img:hover {
  opacity: 1;
  transform: translateY(-3px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

.custom-carousel-arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: white;
  color: #333;
  border: none;
  width: 50px;
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 24px;
  z-index: 10;
  border-radius: 50%;
  transition: all 0.3s ease;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.custom-carousel-arrow:hover {
  background: #2196F3;
  color: white;
  transform: translateY(-50%) scale(1.1);
  box-shadow: 0 6px 30px rgba(33, 150, 243, 0.4);
}

.custom-carousel-prev {
  left: 20px;
}

.custom-carousel-next {
  right: 20px;
}

/* Image Lightbox Modal */
.image-lightbox {
  display: none;
  position: fixed;
  z-index: 10000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.95);
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.lightbox-content {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.lightbox-image {
  max-width: 90%;
  max-height: 90vh;
  object-fit: contain;
  animation: zoomIn 0.3s ease;
}

@keyframes zoomIn {
  from {
    transform: scale(0.8);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.lightbox-close {
  position: absolute;
  top: 20px;
  right: 35px;
  color: white;
  font-size: 40px;
  font-weight: bold;
  cursor: pointer;
  background: rgba(0, 0, 0, 0.5);
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  z-index: 10001;
}

.lightbox-close:hover {
  background: rgba(33, 150, 243, 0.8);
  transform: rotate(90deg);
}

.lightbox-prev,
.lightbox-next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  color: white;
  font-size: 30px;
  font-weight: bold;
  cursor: pointer;
  background: rgba(0, 0, 0, 0.5);
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  z-index: 10001;
  user-select: none;
}

.lightbox-prev:hover,
.lightbox-next:hover {
  background: rgba(33, 150, 243, 0.8);
  transform: translateY(-50%) scale(1.1);
}

.lightbox-prev {
  left: 30px;
}

.lightbox-next {
  right: 30px;
}

.lightbox-counter {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  color: white;
  background: rgba(0, 0, 0, 0.7);
  padding: 10px 20px;
  border-radius: 25px;
  font-size: 16px;
  font-weight: 600;
  z-index: 10001;
}

/* Language Picker Styles */
.lang-picker-wrapper {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}

.lang-picker-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 12px;
  border: 2px solid #e8eef3;
  background: white;
  cursor: pointer;
  font-weight: 500;
  font-size: 14px;
  min-width: 90px;
  height: 40px;
  line-height: 1.2;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.lang-picker-btn:hover {
  border-color: #2196F3;
  box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
  transform: translateY(-1px);
}

.lang-picker-btn:focus,
.lang-picker-btn[aria-expanded="true"] {
  outline: none;
  border-color: #2196F3;
  box-shadow: 0 0 0 4px rgba(33, 150, 243, 0.1);
}

.lang-picker-dropdown {
  display: none;
  position: absolute;
  top: 110%;
  left: 0;
  z-index: 1000;
  background: white;
  border: 2px solid #e8eef3;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
  padding: 8px;
  margin: 0;
  min-width: 140px;
  list-style: none;
}

.lang-picker-dropdown.open {
  display: block;
  animation: fadeSlideIn 0.3s ease;
}

@keyframes fadeSlideIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.lang-option {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  cursor: pointer;
  font-size: 14px;
  background: none;
  border: none;
  border-radius: 8px;
  transition: all 0.2s ease;
  height: 40px;
  line-height: 1.2;
}

.lang-option:hover {
  background: #f0f7ff;
  color: #2196F3;
}

.lang-option.selected {
  background: #2196F3;
  color: white;
  font-weight: 600;
}

.lang-flag {
  font-size: 20px;
  width: 24px;
  display: inline-block;
  text-align: center;
}

.lang-globe {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  margin-right: 4px;
}

.lang-code {
  font-weight: 600;
}

/* ============================================
   COMPACT SPECS CONTAINER
   ============================================ */

.compact-specs-container {
  background: white;
  border-radius: 20px;
  padding: 32px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
  margin-bottom: 40px;
  border: 2px solid #f0f4f8;
}

.compact-specs-container h4 {
  margin-bottom: 28px;
  color: #1a202c;
  font-size: 1.5rem;
  font-weight: 700;
  text-align: center;
  position: relative;
  padding-bottom: 16px;
}

.compact-specs-container h4::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 4px;
  background: linear-gradient(90deg, #2196F3, #21CBF3);
  border-radius: 4px;
}

/* Quick Specs Grid */
.compact-specs-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
  gap: 16px;
  width: 100%;
}

/* Individual Spec Cards */
.spec-card {
  background: #f8fafc;
  border-radius: 16px;
  padding: 20px 16px;
  text-align: center;
  border: 2px solid #e8eef3;
  min-height: 100px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: default;
}

.spec-card:hover {
  background: white;
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(33, 150, 243, 0.12);
  border-color: #2196F3;
}

.spec-card > div:first-child {
  margin-bottom: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  border-radius: 12px;
  background: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
}

.spec-card:hover > div:first-child {
  transform: scale(1.1) rotate(5deg);
  box-shadow: 0 4px 16px rgba(33, 150, 243, 0.2);
}

.spec-card > div:first-child svg {
  transition: all 0.3s ease;
}

.spec-card:hover > div:first-child svg {
  filter: brightness(0) saturate(100%) invert(46%) sepia(99%) saturate(1878%) hue-rotate(187deg) brightness(98%) contrast(90%);
}

.spec-card > div:last-child {
  font-size: 0.95rem;
  font-weight: 600;
  color: #4a5568;
  line-height: 1.4;
  transition: color 0.3s ease;
}

.spec-card:hover > div:last-child {
  color: #2196F3;
}

/* ============================================
   BOOKING FORM - УЛУЧШЕННЫЙ ДИЗАЙН
   ============================================ */

.booking-form-main {
  background: white;
  border-radius: 24px;
  padding: 40px 30px;
  margin-bottom: 50px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08);
  border: 2px solid #f0f4f8;
}

.booking-form-main h4 {
  margin-bottom: 32px;
  color: #1a202c;
  font-size: 1.8rem;
  font-weight: 700;
  text-align: center;
  position: relative;
  padding-bottom: 16px;
}

.booking-form-main h4::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, #2196F3, #21CBF3);
  border-radius: 4px;
}

/* Booking Form Grid - 2 колонки на десктопе */
.booking-form-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 30px;
  margin-bottom: 30px;
}

/* Booking Sections */
.booking-section {
  background: #f8fafc;
  border-radius: 16px;
  padding: 24px;
  border: 2px solid #e8eef3;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.booking-section:hover {
  background: white;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
  border-color: #2196F3;
}

.booking-section h5 {
  margin: 0 0 20px 0;
  color: #1a202c;
  font-size: 1.15rem;
  font-weight: 700;
  padding-bottom: 12px;
  border-bottom: 2px solid #e8eef3;
  display: flex;
  align-items: center;
  gap: 10px;
}

.booking-section h5 i {
  font-size: 1.2rem;
  color: #2196F3;
}

/* Form Labels */
.form-label {
  display: block;
  font-size: 0.875rem;
  font-weight: 600;
  color: #4a5568;
  margin-bottom: 8px;
}

/* Form Inputs */
.form-control {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #e8eef3;
  border-radius: 10px;
  font-size: 0.95rem;
  transition: all 0.3s ease;
  background: white;
  color: #2d3748;
  font-weight: 500;
}

.form-control:hover {
  border-color: #cbd5e0;
}

.form-control:focus {
  outline: none;
  border-color: #2196F3;
  box-shadow: 0 0 0 4px rgba(33, 150, 243, 0.1);
  background: white;
}

/* Date Time Grid */
.date-time-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-bottom: 16px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

/* Location Radio Buttons */
.radio-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.radio-label {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 500;
  border: 2px solid transparent;
  background: white;
  font-size: 0.9rem;
}

.radio-label:hover {
  background: #f0f7ff;
  border-color: #bee3f8;
}

.radio-label input[type="radio"] {
  width: 18px;
  height: 18px;
  margin-right: 10px;
  accent-color: #2196F3;
  cursor: pointer;
}

.radio-label input[type="radio"]:checked + span {
  color: #2196F3;
  font-weight: 700;
}

.radio-label:has(input[type="radio"]:checked) {
  background: #e3f2fd;
  border-color: #2196F3;
  box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15);
}

/* Outside Hours Notice */
#outside-hours-notice {
  display: none;
  background: #fffbeb;
  border: 2px solid #fcd34d;
  border-radius: 12px;
  padding: 14px 18px;
  margin-top: 16px;
  font-size: 0.875rem;
  box-shadow: 0 2px 8px rgba(252, 211, 77, 0.2);
}

#outside-hours-notice strong {
  color: #92400e;
  font-weight: 700;
}

/* Submit Button */
#send_message {
  width: 100%;
  padding: 18px;
  background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
  color: white;
  border: none;
  border-radius: 14px;
  font-size: 1.15rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 8px 24px rgba(33, 150, 243, 0.3);
  position: relative;
  overflow: hidden;
}

#send_message::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.5s ease;
}

#send_message:hover::before {
  left: 100%;
}

#send_message:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 32px rgba(33, 150, 243, 0.4);
}

#send_message:active {
  transform: translateY(0);
  box-shadow: 0 4px 16px rgba(33, 150, 243, 0.3);
}

/* ============================================
   FLATPICKR CALENDAR STYLING
   ============================================ */

.flatpickr-day.occupied {
  background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
  border: 2px solid #ef4444 !important;
  color: #991b1b !important;
  position: relative;
  cursor: not-allowed;
  font-weight: 600;
}

.flatpickr-day.occupied::before {
  content: '🚗';
  position: absolute;
  top: 2px;
  right: 2px;
  font-size: 11px;
  filter: grayscale(0.5);
}

.flatpickr-day.occupied:hover {
  background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%) !important;
  border-color: #dc2626 !important;
}

.flatpickr-day:not(.occupied):not(.flatpickr-disabled):hover {
  background: linear-gradient(135deg, #dbeafe, #bfdbfe);
  border-color: #2196F3;
  transform: scale(1.05);
  box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
}

.flatpickr-day.selected {
  background: linear-gradient(135deg, #2196F3, #1976D2) !important;
  border-color: #1565C0 !important;
  box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4);
  font-weight: 700;
  color: white !important;
}

.flatpickr-day.today {
  border: 2px solid #2196F3;
  font-weight: 700;
  background: #e3f2fd;
}

.flatpickr-day.today:not(.selected) {
  color: #1565C0;
}

.flatpickr-months {
  background: linear-gradient(135deg, #2196F3, #1976D2);
  padding: 16px 0;
  border-radius: 16px 16px 0 0;
}

.flatpickr-current-month {
  color: white;
  font-weight: 700;
  font-size: 1.1rem;
}

.flatpickr-prev-month,
.flatpickr-next-month {
  fill: white;
  padding: 8px;
}

.flatpickr-prev-month:hover,
.flatpickr-next-month:hover {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 8px;
}

.flatpickr-prev-month:hover svg,
.flatpickr-next-month:hover svg {
  fill: white;
}

.flatpickr-weekday {
  color: #1565C0;
  font-weight: 700;
  font-size: 0.9rem;
}

.flatpickr-calendar {
  border-radius: 16px;
  box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15);
  border: 2px solid #e8eef3;
  overflow: hidden;
}

.flatpickr-days {
  padding: 8px;
}

.flatpickr-day {
  border-radius: 8px;
  margin: 2px;
  font-weight: 500;
}

.flatpickr-day.flatpickr-disabled {
  color: #cbd5e0 !important;
  background: #f7fafc;
  cursor: not-allowed;
  position: relative;
}

.flatpickr-day.flatpickr-disabled::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 10%;
  right: 10%;
  height: 1px;
  background: #e2e8f0;
}

/* ============================================
   RESPONSIVE DESIGN
   ============================================ */

/* Desktop Large - 1200px+ */
@media (min-width: 1200px) {
  .booking-form-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Tablet - 768px to 1199px */
@media (max-width: 1199px) {
  .booking-form-grid {
    grid-template-columns: 1fr;
    gap: 24px;
  }
  
  .booking-form-main {
    padding: 32px 24px;
  }
}

/* Mobile - до 767px */
@media (max-width: 767px) {
  .custom-carousel-main {
    height: 300px;
  }

  .booking-form-main {
    padding: 24px 18px;
    border-radius: 20px;
    margin-bottom: 30px;
  }
  
  .booking-form-main h4 {
    font-size: 1.5rem;
    margin-bottom: 24px;
  }
  
  .booking-form-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .booking-section {
    padding: 20px 16px;
  }
  
  .booking-section h5 {
    font-size: 1.05rem;
    cursor: pointer;
    user-select: none;
    position: relative;
    padding-right: 35px;
  }

  .booking-section h5::after {
    content: '▼';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    font-size: 13px;
    color: #718096;
    transition: transform 0.3s ease;
  }

  .booking-section.collapsed h5::after {
    transform: translateY(-50%) rotate(-90deg);
  }

  .booking-section-content {
    max-height: 1000px;
    overflow: hidden;
    opacity: 1;
    transform: translateY(0);
    transition: all 0.3s ease;
  }

  .booking-section.collapsed .booking-section-content {
    max-height: 0;
    opacity: 0;
    transform: translateY(-10px);
  }
  
  .date-time-grid {
    grid-template-columns: 1fr;
    gap: 12px;
  }
  
  .compact-specs-container {
    padding: 24px 18px;
    border-radius: 16px;
    margin-bottom: 30px;
  }
  
  .compact-specs-container h4 {
    font-size: 1.3rem;
    margin-bottom: 20px;
  }
  
  .compact-specs-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
  }
  
  .spec-card {
    padding: 16px 12px;
    min-height: 90px;
  }

  .spec-card > div:first-child {
    width: 40px;
    height: 40px;
  }
  
  #send_message {
    padding: 16px;
    font-size: 1.05rem;
  }

  /* Lightbox на мобильных */
  .lightbox-prev,
  .lightbox-next {
    width: 50px;
    height: 50px;
    font-size: 24px;
  }

  .lightbox-prev {
    left: 10px;
  }

  .lightbox-next {
    right: 10px;
  }

  .lightbox-close {
    top: 10px;
    right: 10px;
    width: 45px;
    height: 45px;
    font-size: 35px;
  }

  .lightbox-counter {
    bottom: 15px;
    font-size: 14px;
    padding: 8px 16px;
  }
}

@media (max-width: 600px) {
  .lang-picker-btn {
    font-size: 13px;
    padding: 6px 12px;
    min-width: 75px;
    height: 36px;
  }

  .lang-picker-dropdown {
    min-width: 110px;
  }

  .lang-option {
    font-size: 13px;
    padding: 8px 12px;
    height: 36px;
  }
}

@media (max-width: 480px) {
  .custom-carousel-main {
    height: 250px;
  }

  .booking-form-main {
    padding: 20px 16px;
    border-radius: 16px;
  }

  .booking-form-main h4 {
    font-size: 1.3rem;
  }
  
  .booking-section {
    padding: 18px 14px;
  }
  
  .booking-section h5 {
    font-size: 1rem;
  }
  
  .compact-specs-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  
  .spec-card {
    padding: 14px 10px;
    min-height: 80px;
  }
  
  .spec-card > div:first-child {
    width: 36px;
    height: 36px;
  }
  
  #send_message {
    padding: 14px;
    font-size: 1rem;
  }
}

/* Mobile menu text */
header.menu-open #mainmenu a,
header.header-mobile #mainmenu a {
  color: #2c2c2c !important;
}

header.menu-open #mainmenu a:hover,
header.header-mobile #mainmenu a:hover {
  color: #1a1a1a !important;
}

/* Helper classes */
.mb15 {
  margin-bottom: 15px !important;
}

.mb20 {
  margin-bottom: 20px !important;
}
</style>

</head>

<body>
  <!-- Universal Error Popup -->
  <div id="universal-error-popup" class="universal-error-popup" style="display: none;">
    <div class="universal-error-content">
      <div class="universal-error-icon">
        <i class="fa fa-exclamation-triangle"></i>
      </div>
      <div class="universal-error-text">
        <span id="universal-error-message"></span>
      </div>
      <button type="button" class="universal-error-close" onclick="hideUniversalError()">
        <i class="fa fa-times"></i>
      </button>
    </div>
  </div>

  <!-- Image Lightbox Modal -->
  <div id="imageLightbox" class="image-lightbox">
    <span class="lightbox-close">&times;</span>
    <span class="lightbox-prev">‹</span>
    <span class="lightbox-next">›</span>
    <div class="lightbox-content">
      <img class="lightbox-image" id="lightboxImage" src="" alt="Full size image">
    </div>
    <div class="lightbox-counter">
      <span id="lightboxCounter">1 / 1</span>
    </div>
  </div>

  <div id="wrapper">

    <!-- header begin -->
    <header class="transparent scroll-light has-topbar">
      <div id="topbar" class="topbar-dark text-light">
        <div class="container">
          <div class="topbar-left xs-hide">
            <div class="topbar-widget">
              <div class="topbar-widget"><a href="tel:060000500"><i class="fa fa-phone"></i>060000500</a></div>
              <div class="topbar-widget"><a href="mailto:contact@plusrent.md"><i
                    class="fa fa-envelope"></i>contact@plusrent.md</a></div>
              <div class="topbar-widget"><i class="fa fa-clock-o"></i>24/7</div>
            </div>
          </div>

          <div class="topbar-right">
            <div class="social-icons">
              <a href="https://www.instagram.com/plusrent.md/" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-instagram fa-lg"></i></a>
              <a href="https://tiktok.me/plusrent" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-tiktok fa-lg"></i></a>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <div class="de-flex sm-pt10">
              <div class="de-flex-col">
                <div class="de-flex-col">
                  <div id="logo">
                    <a href="/">
                      <img class="logo-1" src="images/LOGO-4-demo.png" alt="">
                      <img class="logo-2" src="images/LOGO-5-demo.png" alt="">
                    </a>
                  </div>
                </div>
              </div>

              <div class="de-flex-col">
                <ul id="mainmenu">
                  <li><a class="menu-item" href="/" data-i18n="menu.home"></a></li>
                  <li><a class="menu-item" href="/cars" data-i18n="menu.cars"></a></li>
                  <li><a class="menu-item" href="/about" data-i18n="menu.about"></a></li>
                  <li><a class="menu-item" href="/contact" data-i18n="menu.contact"></a></li>
                  <li><a class="menu-item" href="/sofer-treaz" data-i18n="menu.sober_driver"></a></li>
                </ul>
              </div>

              <div class="de-flex-col">
                <div class="menu_side_area"
                  style="display: flex; align-items: center; justify-content: flex-end; gap: 12px;">
                  <div class="call-now-wrapper" style="align-self:center; margin-right: 2vw;">
                    <a href="tel:060000500" class="call-now-btn"
                      style="display: flex; align-items: center; gap: 8px; background: linear-gradient(135deg, #1E90FF, #187bcd); color: white; padding: 10px 16px; border-radius: 25px; text-decoration: none; font-weight: 600; font-size: 14px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(30, 144, 255, 0.3); position: relative; overflow: hidden;">
                      <i class="fa fa-phone" style="font-size: 12px;"></i>
                      <span data-i18n="call_now">Call Now</span>
                    </a>
                  </div>
                  <div class="lang-picker-wrapper" style="min-width:120px;align-self:center;">
                    <button id="langPickerBtn" class="lang-picker-btn" aria-haspopup="listbox" aria-expanded="false"
                      style="height:36px;display:flex;align-items:center;">
                      <span class="lang-globe" id="langGlobe"
                        style="display:inline-flex;align-items:center;justify-content:center;width:20px;height:20px;margin-right:3px;">
                        <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <circle cx="10" cy="10" r="9" stroke="#1ccfc9" stroke-width="2" />
                          <ellipse cx="10" cy="10" rx="5" ry="9" stroke="#1ccfc9" stroke-width="2" />
                          <path d="M1 10h18" stroke="#1ccfc9" stroke-width="2" />
                          <path d="M3 4.5h14" stroke="#1ccfc9" stroke-width="1.2" />
                          <path d="M3 15.5h14" stroke="#1ccfc9" stroke-width="1.2" />
                        </svg>
                      </span>
                      <span class="lang-flag" id="langFlag"></span>
                      <span id="langCode" style="font-weight:600;margin:0 2px 0 2px;">RO</span>
                      <svg width="14" height="14" viewBox="0 0 20 20" style="margin-left:6px;">
                        <path d="M5.5 8l4.5 4.5L14.5 8" stroke="#888" stroke-width="2" fill="none"
                          stroke-linecap="round" />
                      </svg>
                    </button>
                    <ul id="langDropdown" class="lang-picker-dropdown" tabindex="-1">
                      <li class="lang-option" data-lang="ro" tabindex="0"><span class="lang-flag"><img
                            src="images/flags/romania.png" alt="RO"
                            style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span
                          class="lang-code">RO</span></li>
                      <li class="lang-option" data-lang="en" tabindex="0"><span class="lang-flag"><img
                            src="images/flags/united-kingdom.png" alt="EN"
                            style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span
                          class="lang-code">EN</span></li>
                      <li class="lang-option" data-lang="ru" tabindex="0"><span class="lang-flag"><img
                            src="images/flags/russia.png" alt="RU"
                            style="width: 20px; height: 15px; border-radius: 2px; object-fit: cover;"></span> <span
                          class="lang-code">RU</span></li>
                    </ul>
                  </div>
                </div>
              </div>

              <div id="menu-btn">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- header close -->

    <!-- content begin -->
    <div class="no-bottom no-top zebra" id="content">
      <div id="top"></div>

      <!-- section begin -->
      <section id="subheader" class="jarallax text-light">
        <img src="images/background/2.jpg" class="jarallax-img" alt="">
        <div class="center-y relative text-center">
          <div class="container">
            <div class="row">
              <div class="col-md-12 text-center">
                <h1 id="car-title">Vehicle Fleet</h1>
              </div>
              <div class="clearfix"></div>
            </div>
          </div>
        </div>
      </section>
      <!-- section close -->

      <section id="section-car-single">
        <div class="container">
          <div class="row g-5">
            <div class="col-lg-12">
              <div class="row">
                <!-- Image Gallery -->
                <div class="col-lg-8">
                  <div class="custom-carousel">
                    <div class="custom-carousel-main" id="car-images" onclick="openLightbox(window.currentCarSlide)">
                      <!-- Main images will be inserted here -->
                    </div>
                    <button class="custom-carousel-arrow custom-carousel-prev" onclick="changeSlide(-1)">‹</button>
                    <button class="custom-carousel-arrow custom-carousel-next" onclick="changeSlide(1)">›</button>
                    <div class="custom-carousel-nav" id="car-thumbs">
                      <!-- Thumbnail images will be inserted here -->
                    </div>
                  </div>
                </div>

                <!-- Price Sidebar -->
                <div class="col-lg-4">
                  <h3 id="car-name"></h3>
                  <div class="daily-rate-from"
                    style="background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 15px rgba(0,0,0,0.1); text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 14px; color: #666; margin-bottom: 6px;" data-i18n="cars.daily_rate">Daily
                      rate from</div>
                    <div id="car-price-sidebar" style="font-size: 28px; font-weight: bold; color: #007bff;">€60</div>
                  </div>

                  <div class="price-details-section"
                    style="background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 15px rgba(0,0,0,0.1); width: 100%;">
                    <h5
                      style="margin-bottom: 12px; color: #333; font-weight: 600; text-align: center; border-bottom: 2px solid #007bff; padding-bottom: 6px; font-size: 16px;">
                      <i class="fa fa-euro" style="color: #007bff; margin-right: 6px;"></i>
                      <span data-i18n="cars.pricing_breakdown"></span>
                    </h5>
                    <div id="price-tiers-main"
                      style="font-size: 13px; display: flex; flex-direction: column; gap: 8px; width: 100%;">
                      <!-- Price tiers will be populated by JavaScript -->
                    </div>
                  </div>
                </div>
              </div>

              <!-- BOOKING FORM -->
              <div class="spacer-single"></div>
              <div class="booking-form-main">

                <!-- Booking Success Notification -->
                <div id="booking-success-notification"
                  style="display: none; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 20px; margin-bottom: 20px; text-align: center;">
                  <div
                    style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fa fa-check-circle" style="color: #155724; font-size: 24px;"></i>
                    <h4 style="color: #155724; margin: 0;" data-i18n="booking.success_title">Booking Submitted
                      Successfully!</h4>
                  </div>
                  <p style="color: #155724; margin: 0; font-size: 14px;" data-i18n="booking.success_message">
                    Thank you for your booking request. We will contact you shortly to confirm your reservation.
                  </p>
                </div>

                <!-- Booking Error Notification -->
                <div id="error_message"
                  style="display: none; background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px; padding: 20px; margin-bottom: 20px; text-align: center;">
                  <div
                    style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px;">
                    <i class="fa fa-exclamation-triangle" style="color: #721c24; font-size: 24px;"></i>
                    <h4 style="color: #721c24; margin: 0;" data-i18n="errors.booking_error">Booking Error</h4>
                  </div>
                  <p id="error_message_text" style="color: #721c24; margin: 0; font-size: 14px;"
                    data-i18n="errors.booking_error_message">
                    Please check your form and try again.
                  </p>
                </div>

                <form name="contactForm" id='contact_form' method="post">
                  <h4 data-i18n="cars.book_now">Book Now</h4>

                  <!-- Booking Form Grid - 2 колонки -->
                  <div class="booking-form-grid">

                    <!-- Booking Details Section -->
                    <div class="booking-section">
                      <h5>
                        <i class="fa fa-calendar"></i>
                        <span data-i18n="cars.booking_details">Booking Details</span>
                      </h5>
                      
                      <div class="booking-section-content">
                        <!-- Pickup Date & Time -->
                        <div class="date-time-grid">
                          <div class="form-group">
                            <label class="form-label" data-i18n="cars.pickup_date">Pickup Date</label>
                            <input type="text" id="date-picker" name="Pick Up Date"
                              data-i18n-placeholder="booking.date_placeholder" class="form-control">
                          </div>
                          <div class="form-group">
                            <label class="form-label" data-i18n="cars.pickup_time">Pickup Time</label>
                            <select id="pickup-time" name="Pick Up Time" class="form-control">
                              <option value="00:00">00:00</option>
                              <option value="01:00">01:00</option>
                              <option value="02:00">02:00</option>
                              <option value="03:00">03:00</option>
                              <option value="04:00">04:00</option>
                              <option value="05:00">05:00</option>
                              <option value="06:00">06:00</option>
                              <option value="07:00">07:00</option>
                              <option value="08:00">08:00</option>
                              <option value="09:00" selected>09:00</option>
                              <option value="10:00">10:00</option>
                              <option value="11:00">11:00</option>
                              <option value="12:00">12:00</option>
                              <option value="13:00">13:00</option>
                              <option value="14:00">14:00</option>
                              <option value="15:00">15:00</option>
                              <option value="16:00">16:00</option>
                              <option value="17:00">17:00</option>
                              <option value="18:00">18:00</option>
                              <option value="19:00">19:00</option>
                              <option value="20:00">20:00</option>
                              <option value="21:00">21:00</option>
                              <option value="22:00">22:00</option>
                              <option value="23:00">23:00</option>
                            </select>
                          </div>
                        </div>

                        <!-- Return Date & Time -->
                        <div class="date-time-grid">
                          <div class="form-group">
                            <label class="form-label" data-i18n="cars.return_date">Return Date</label>
                            <input type="text" id="date-picker-2" name="Collection Date"
                              data-i18n-placeholder="booking.date_placeholder" class="form-control">
                          </div>
                          <div class="form-group">
                            <label class="form-label" data-i18n="cars.return_time">Return Time</label>
                            <select id="collection-time" name="Collection Time" class="form-control">
                              <option value="00:00">00:00</option>
                              <option value="01:00">01:00</option>
                              <option value="02:00">02:00</option>
                              <option value="03:00">03:00</option>
                              <option value="04:00">04:00</option>
                              <option value="05:00">05:00</option>
                              <option value="06:00">06:00</option>
                              <option value="07:00">07:00</option>
                              <option value="08:00">08:00</option>
                              <option value="09:00" selected>09:00</option>
                              <option value="10:00">10:00</option>
                              <option value="11:00">11:00</option>
                              <option value="12:00">12:00</option>
                              <option value="13:00">13:00</option>
                              <option value="14:00">14:00</option>
                              <option value="15:00">15:00</option>
                              <option value="16:00">16:00</option>
                              <option value="17:00">17:00</option>
                              <option value="18:00">18:00</option>
                              <option value="19:00">19:00</option>
                              <option value="20:00">20:00</option>
                              <option value="21:00">21:00</option>
                              <option value="22:00">22:00</option>
                              <option value="23:00">23:00</option>
                            </select>
                          </div>
                        </div>

                        <!-- Outside Hours Notice -->
                        <div id="outside-hours-notice">
                          <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 4px;">
                            <i class="fa fa-clock-o"></i>
                            <strong data-i18n="price_calculator.outside_hours">Outside Working Hours</strong>
                          </div>
                          <div id="outside-hours-details"></div>
                          <div style="font-size: 11px;">
                            <strong data-i18n="price_calculator.working_hours">Working Hours:</strong> 08:00 - 18:00 |
                            <strong data-i18n="price_calculator.fee">Fee:</strong> <span id="outside-hours-fee">€15</span>
                            <span data-i18n="price_calculator.per_pickup_return"></span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Location Details Section -->
                    <div class="booking-section">
                      <h5>
                        <i class="fa fa-map-marker"></i>
                        <span data-i18n="cars.location_details">Location Details</span>
                      </h5>
                      
                      <div class="booking-section-content">
                        <!-- Pickup Location -->
                        <div class="form-group mb20">
                          <label class="form-label" data-i18n="cars.pickup_location">Pickup Location</label>
                          <div class="radio-group">
                            <label class="radio-label">
                              <input type="radio" name="pickup_location" value="Chisinau Airport">
                              <span data-i18n="cars.chisinau_airport">Chisinau Airport</span>
                            </label>
                            <label class="radio-label">
                              <input type="radio" name="pickup_location" value="Our Office">
                              <span data-i18n="cars.our_office">Our Office</span>
                            </label>
                            <label class="radio-label">
                              <input type="radio" name="pickup_location" value="Iasi Airport" checked>
                              <span data-i18n="cars.iasi_airport">Iasi Airport</span>
                            </label>
                          </div>
                        </div>

                        <!-- Dropoff Location -->
                        <div class="form-group">
                          <label class="form-label" data-i18n="cars.dropoff_location">Dropoff Location</label>
                          <div class="radio-group">
                            <label class="radio-label">
                              <input type="radio" name="dropoff_location" value="Chisinau Airport">
                              <span data-i18n="cars.chisinau_airport">Chisinau Airport</span>
                            </label>
                            <label class="radio-label">
                              <input type="radio" name="dropoff_location" value="Our Office" checked>
                              <span data-i18n="cars.our_office">Our Office</span>
                            </label>
                            <label class="radio-label">
                              <input type="radio" name="dropoff_location" value="Iasi Airport">
                              <span data-i18n="cars.iasi_airport">Iasi Airport</span>
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Contact Information Section -->
                    <div class="booking-section">
                      <h5>
                        <i class="fa fa-user"></i>
                        <span data-i18n="cars.contact_information">Contact Information</span>
                      </h5>
                      
                      <div class="booking-section-content">
                        <div class="form-group mb15">
                          <label class="form-label" data-i18n="cars.email_address">Email Address</label>
                          <input type="email" name="customer_email" placeholder="your.email@example.com" class="form-control">
                        </div>
                        <div class="form-group mb15">
                          <label class="form-label" data-i18n="cars.phone_number">Phone Number</label>
                          <input type="tel" name="customer_phone" placeholder="+1 234 567 8900" required class="form-control">
                        </div>
                        <div class="form-group mb15">
                          <label class="form-label" data-i18n="cars.customer_age">Age</label>
                          <input type="number" name="customer_age" placeholder="25" min="18" max="100" required class="form-control">
                        </div>
                        <div class="form-group">
                          <label class="form-label" data-i18n="cars.discount_code">Discount Code</label>
                          <input type="text" name="discount_code" placeholder="Enter discount code"
                            data-i18n-placeholder="cars.discount_code_placeholder" data-coupon-input class="form-control">
                        </div>
                      </div>
                    </div>

                    <!-- Price Summary Section -->
                    <div class="booking-section">
                      <h5>
                        <i class="fa fa-calculator"></i>
                        <span data-i18n="cars.total_price_breakdown">Total Price</span>
                      </h5>
                      
                      <div class="booking-section-content">
                        <div id="price-loading"
                          style="display: flex; align-items: center; justify-content: center; gap: 8px; min-height: 80px;">
                          <span style="font-size: 12px; color: #6c757d;">Loading...</span>
                        </div>
                        <div id="price-content" style="display: none;">
                          <!-- Price content will be populated by JavaScript -->
                        </div>
                      </div>
                    </div>

                  </div>

                  <button type='submit' id='send_message' class="btn-main btn-fullwidth" data-i18n="cars.book_now">Book Now</button>

                  <div class="clearfix"></div>
                </form>
              </div>

              <!-- Compact Quick Specs Section -->
              <div class="spacer-10"></div>
              <div class="compact-specs-container">
                <h4 data-i18n="cars.quick_specs">Quick Specs</h4>
                <div class="compact-specs-grid" id="car-specs-compact">
                  <!-- Specs will be populated by JavaScript -->
                </div>
              </div>

              <!-- Description Section -->
              <div class="spacer-10"></div>
              <h4 data-i18n="cars.description">Description</h4>
              <p id="car-description"></p>

              <div class="spacer-single"></div>
            </div>

          </div>
        </div>
      </section>

    </div>
    <!-- content close -->

    <a href="#" id="back-to-top"></a>

    <!-- footer begin -->
    <footer class="text-light">
      <div class="container">
        <div class="row g-custom-x">
          <div class="col-lg-3">
            <div class="widget">
              <h5>About PlusRent</h5>
              <p>Where quality meets affordability. We understand the importance of a smooth and enjoyable journey without
                the burden of excessive costs. That's why we have meticulously crafted our offerings to provide you with
                top-notch vehicles at minimum expense.</p>
            </div>
          </div>

          <div class="col-lg-3">
            <div class="widget">
              <h5>Contact Info</h5>
              <address class="s1">
                <span><i class="id-color fa fa-map-marker fa-lg"></i>Meșterul Manole 20, Chișinău, Republica
                  Moldova</span>
                <span><i class="id-color fa fa-phone fa-lg"></i>060000500</span>
                <span><i class="id-color fa fa-envelope-o fa-lg"></i>
                    href="mailto:contact@plusrent.md">contact@plusrent.md</a></span>
              </address>
            </div>
          </div>

          <div class="col-lg-3">
            <h5 data-i18n="footer.quick_links">Quick Links</h5>
            <div class="widget">
              <ul>
                <li><a href="/" data-i18n="menu.home">Home</a></li>
                <li><a href="/cars" data-i18n="menu.cars">Cars</a></li>
                <li><a href="/about" data-i18n="menu.about">About</a></li>
                <li><a href="/contact" data-i18n="menu.contact">Contact</a></li>
                <li><a href="/sofer-treaz" data-i18n="menu.sober_driver">Sober Driver</a></li>
              </ul>
            </div>
          </div>

          <div class="col-lg-3">
            <div class="widget">
              <h5>Social Network</h5>
              <div class="social-icons">
                <a href="https://www.instagram.com/plusrent.md/" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-instagram fa-lg"></i></a>
                <a href="https://tiktok.me/plusrent" target="_blank" rel="noopener noreferrer"><i
                    class="fab fa-tiktok fa-lg"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="subfooter">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="de-flex">
                <div class="de-flex-col">
                  <a href="/">
                    Copyright 2025 - PlusRent
                  </a>
                </div>
                <ul class="menu-simple">
                  <li><a href="/terms" data-i18n="terms.footer_terms">Terms &amp; Conditions</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- footer close -->

  </div>

  <!-- Javascript Files -->
  <script src="js/plugins.js"></script>
  <script src="js/designesia.js"></script>
  <script src="js/config.js"></script>
  <script src="js/price-calculator.js"></script>
  <script src="js/booking-form-handler.js?v=1.1"></script>
  <script src="js/validation-booking.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="js/date-picker-manager.js"></script>

  <!-- i18next CDN -->
  <script src="https://unpkg.com/i18next@21.6.16/dist/umd/i18next.min.js"></script>
  <script src="https://unpkg.com/i18next-http-backend@1.4.3/i18nextHttpBackend.min.js"></script>

  <!-- Translation System -->
  <script src="js/i18n-init.js"></script>

  <!-- Universal Spinning Wheel -->
  <script src="js/universal-include.js"></script>

  <!-- Auto-Apply Coupon -->
  <script src="js/auto-apply-coupon.js"></script>

  <script>
    // Global formatting function
    function formatDisplayText(rawKey) {
      if (!rawKey) return '';
      return rawKey
        .split('_')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
        .join(' ');
    }

    // Lightbox functionality
    let lightboxImages = [];
    let currentLightboxIndex = 0;

    function openLightbox(index) {
      const lightbox = document.getElementById('imageLightbox');
      const lightboxImg = document.getElementById('lightboxImage');
      const counter = document.getElementById('lightboxCounter');
      
      currentLightboxIndex = index;
      lightbox.style.display = 'block';
      lightboxImg.src = lightboxImages[currentLightboxIndex];
      counter.textContent = `${currentLightboxIndex + 1} / ${lightboxImages.length}`;
      
      document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
      const lightbox = document.getElementById('imageLightbox');
      lightbox.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function changeLightboxImage(direction) {
      currentLightboxIndex += direction;
      
      if (currentLightboxIndex < 0) {
        currentLightboxIndex = lightboxImages.length - 1;
      } else if (currentLightboxIndex >= lightboxImages.length) {
        currentLightboxIndex = 0;
      }
      
      const lightboxImg = document.getElementById('lightboxImage');
      const counter = document.getElementById('lightboxCounter');
      lightboxImg.src = lightboxImages[currentLightboxIndex];
      counter.textContent = `${currentLightboxIndex + 1} / ${lightboxImages.length}`;
    }

    // Event listeners for lightbox
    document.addEventListener('DOMContentLoaded', function() {
      const lightbox = document.getElementById('imageLightbox');
      const closeBtn = document.querySelector('.lightbox-close');
      const prevBtn = document.querySelector('.lightbox-prev');
      const nextBtn = document.querySelector('.lightbox-next');
      
      closeBtn.addEventListener('click', closeLightbox);
      prevBtn.addEventListener('click', () => changeLightboxImage(-1));
      nextBtn.addEventListener('click', () => changeLightboxImage(1));
      
      lightbox.addEventListener('click', function(e) {
        if (e.target === lightbox) {
          closeLightbox();
        }
      });
      
      document.addEventListener('keydown', function(e) {
        if (lightbox.style.display === 'block') {
          if (e.key === 'Escape') {
            closeLightbox();
          } else if (e.key === 'ArrowLeft') {
            changeLightboxImage(-1);
          } else if (e.key === 'ArrowRight') {
            changeLightboxImage(1);
          }
        }
      });
    });

    document.addEventListener('DOMContentLoaded', async function () {
      // Wait for i18n
      function waitForI18n() {
        if (typeof i18next !== 'undefined' && typeof updateContent === 'function') {
          updateContent();
        } else {
          setTimeout(waitForI18n, 100);
        }
      }
      waitForI18n();

      // Initialize accordion
      initializeAccordion();

      // Get car ID
      const urlParams = new URLSearchParams(window.location.search);
      const carId = urlParams.get('id');

      if (!carId) {
        document.getElementById('car-title').textContent = 'Car not found';
        return;
      }

      // Initialize booking form handler
      const bookingHandler = new BookingFormHandler({
        carId: carId,
        onSuccess: function (response, bookingData) {
          const bookingForm = document.getElementById('contact_form');
          if (bookingForm) {
            bookingForm.style.display = 'none';
          }

          const infoMessage = document.getElementById('booking-info-message');
          if (infoMessage) {
            infoMessage.style.display = 'none';
          }

          const successNotification = document.getElementById('booking-success-notification');
          if (successNotification) {
            successNotification.style.display = 'block';
          }

          successNotification.scrollIntoView({ behavior: 'smooth', block: 'center' });

          localStorage.removeItem('autoApplyCoupon');
          localStorage.removeItem('spinningWheelWinningCoupon');

          document.dispatchEvent(new CustomEvent('bookingSuccess', {
            detail: { bookingData: bookingData }
          }));
        },
        onError: function (errorMessage) {
          // Error handling
        },
        onValidationError: function (errorMessage) {
          setTimeout(() => {
            if (window.showError && typeof window.showError === 'function') {
              window.showError(errorMessage);
            } else {
              const submitButton = document.getElementById('send_message');
              const successNotification = document.getElementById('booking-success-notification');

              if (successNotification) {
                successNotification.style.display = 'none';
              }

              let infoMessage = document.getElementById('booking-info-message');
              if (!infoMessage) {
                infoMessage = document.createElement('div');
                infoMessage.id = 'booking-info-message';
                infoMessage.style.cssText = 'display: block; background: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 6px; padding: 12px; margin-top: 10px; text-align: center; font-size: 13px; color: #0056b3;';

                if (submitButton) {
                  submitButton.parentNode.insertBefore(infoMessage, submitButton.nextSibling);
                }
              } else {
                infoMessage.style.display = 'block';
              }

              let translatedMessage = errorMessage;
              if (typeof i18next !== 'undefined') {
                const errorTranslations = {
                  'For same-day rentals, return time must be after pickup time': 'booking.validation.same_day_time',
                  'Return date must be after pickup date': 'booking.validation.return_date_after_pickup',
                  'Please select pickup and return dates': 'booking.validation.select_dates',
                  'Please select pickup and return times': 'booking.validation.select_times',
                  'Please select pickup and dropoff locations': 'booking.validation.select_locations',
                  'Please enter your phone number': 'booking.validation.phone_required',
                  'Please enter a valid phone number': 'booking.validation.phone_invalid',
                  'Please enter a valid email address': 'booking.validation.email_invalid',
                  'Pickup date must be today or in the future': 'booking.validation.pickup_date_future',
                  'Phone number is required for outside hours pickup/dropoff': 'booking.validation.phone_required_outside_hours',
                  'Please enter your age': 'booking.validation.age_required',
                  'Age must be between 18 and 100 years': 'booking.validation.age_invalid'
                };

                const translationKey = errorTranslations[errorMessage];
                if (translationKey) {
                  translatedMessage = i18next.t(translationKey, errorMessage);
                }
              }

              infoMessage.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                  <i class="fa fa-info-circle" style="font-size: 16px;"></i>
                  <span>${translatedMessage}</span>
                </div>
              `;

              if (window.bookingInfoTimeout) {
                clearTimeout(window.bookingInfoTimeout);
              }

              window.bookingInfoTimeout = setTimeout(() => {
                if (infoMessage) {
                  infoMessage.style.display = 'none';
                }
              }, 5000);
            }
          }, 100);
        }
      });

      bookingHandler.initForm('contact_form', 'send_message');

      // Initialize DatePickerManager
      const datePickerManager = new DatePickerManager({
        pickupInputId: "date-picker",
        returnInputId: "date-picker-2",
        carId: carId || null,
        dateFormat: "d-m-Y",
        onDateChange: function () {
          if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === "function") {
            window.priceCalculator.recalculatePrice();
          }
        }
      });

      datePickerManager.initialize();

      // Fetch car data
      let car;
      try {
        const apiUrl = `${window.API_BASE_URL}/api/cars/${carId}`;
        const res = await fetch(apiUrl);

        if (!res.ok) {
          throw new Error('Not found');
        }

        car = await res.json();
      } catch (e) {
        document.getElementById('car-title').textContent = 'Car not found';
        return;
      }

      // Images
      const imagesDiv = document.getElementById('car-images');
      const thumbsDiv = document.getElementById('car-thumbs');

      let mainImages = [];
      let thumbImages = [];

      if (car.gallery_images && car.gallery_images.length) {
        mainImages = car.gallery_images.map(img => img.startsWith('http') ? img : `${window.API_BASE_URL}${img}`);
        thumbImages = mainImages;
      } else if (car.head_image) {
        mainImages = [car.head_image.startsWith('http') ? car.head_image : window.API_BASE_URL + car.head_image];
        thumbImages = mainImages;
      } else {
        mainImages = [window.API_BASE_URL + '/uploads/placeholder.png'];
        thumbImages = mainImages;
      }

      lightboxImages = mainImages;

      let currentSlide = 0;
      window.currentCarSlide = 0;
      const totalSlides = thumbImages.length;

      imagesDiv.innerHTML = '';
      thumbsDiv.innerHTML = '';

      thumbImages.forEach((imagePath, index) => {
        const img = document.createElement('img');
        img.src = imagePath + '?v=' + Date.now();
        img.alt = `Car image ${index + 1}`;
        img.onerror = function () {
          this.onerror = null;
          this.src = window.API_BASE_URL + '/uploads/placeholder.png';
        };
        img.style.display = index === 0 ? 'block' : 'none';
        if (index === 0) img.classList.add('active');
        imagesDiv.appendChild(img);
      });

      thumbImages.forEach((imagePath, index) => {
        const img = document.createElement('img');
        img.src = imagePath + '?v=' + Date.now();
        img.alt = `Thumbnail ${index + 1}`;
        img.onerror = function () {
          this.onerror = null;
          this.src = window.API_BASE_URL + '/uploads/placeholder.png';
        };
        img.onclick = () => goToSlide(index);
        if (index === 0) img.classList.add('active');
        thumbsDiv.appendChild(img);
      });

      window.changeSlide = function (direction) {
        const newSlide = (currentSlide + direction + totalSlides) % totalSlides;
        goToSlide(newSlide);
      };

      function goToSlide(index) {
        const mainImages = imagesDiv.querySelectorAll('img');
        mainImages.forEach(img => {
          img.style.display = 'none';
          img.classList.remove('active');
        });

        mainImages[index].style.display = 'block';
        mainImages[index].classList.add('active');

        const thumbImages = thumbsDiv.querySelectorAll('img');
        thumbImages.forEach(img => img.classList.remove('active'));
        thumbImages[index].classList.add('active');

        if (thumbImages[index]) {
          thumbImages[index].scrollIntoView({
            behavior: 'smooth',
            block: 'nearest',
            inline: 'center'
          });
        }

        currentSlide = index;
        window.currentCarSlide = index;
      }

      document.addEventListener('keydown', (e) => {
        const lightbox = document.getElementById('imageLightbox');
        if (lightbox.style.display !== 'block') {
          if (e.key === 'ArrowLeft') {
            changeSlide(-1);
          } else if (e.key === 'ArrowRight') {
            changeSlide(1);
          }
        }
      });

      let startX = 0;
      let endX = 0;

      imagesDiv.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
      });

      imagesDiv.addEventListener('touchend', (e) => {
        endX = e.changedTouches[0].clientX;
        const diff = startX - endX;

        if (Math.abs(diff) > 50) {
          if (diff > 0) {
            changeSlide(1);
          } else {
            changeSlide(-1);
          }
        }
      });

      document.getElementById('car-title').textContent = `${formatDisplayText(car.make_name)} ${formatDisplayText(car.model_name)} ${car.production_year}`;
      document.getElementById('car-name').textContent = `${formatDisplayText(car.make_name)} ${formatDisplayText(car.model_name)}`;

      window.currentCarData = car;

      if (typeof CarMetaUpdater !== 'undefined') {
        const metaUpdater = new CarMetaUpdater();
        window.metaUpdater = metaUpdater;
        metaUpdater.updateMetaTags(car);
      }

      updateCarDescription();

      let lowestPrice = '';
      if (car.price_policy) {
        const pricePolicy = typeof car.price_policy === 'string' ? JSON.parse(car.price_policy) : car.price_policy;
        const prices = Object.values(pricePolicy).map(price => parseInt(price));
        lowestPrice = Math.min(...prices).toString();
      }

      document.getElementById('car-price-sidebar').innerHTML = `€${lowestPrice}`;

      populatePriceGuide(car);

      if (typeof updateContent === 'function') {
        updateContent();
      }

      showImmediatePriceInfo(car, lowestPrice);

      function updateCarDescription() {
        if (!window.currentCarData) return;

        const car = window.currentCarData;
        let descriptionText = '';

        try {
          if (car.description) {
            let descriptionObj;
            if (typeof car.description === 'string') {
              try {
                descriptionObj = JSON.parse(car.description);
              } catch (parseError) {
                descriptionText = car.description;
                return;
              }
            } else {
              descriptionObj = car.description;
            }

            const currentLang = i18next.language || 'en';
            descriptionText = descriptionObj[currentLang] || descriptionObj.en || descriptionObj.ro || descriptionObj.ru || '';
          }
        } catch (e) {
          descriptionText = car.description || '';
        }

        const descriptionElement = document.getElementById('car-description');
        if (descriptionElement) {
          descriptionElement.textContent = descriptionText;
        }
      }

      if (typeof i18next !== 'undefined') {
        i18next.on('languageChanged', function () {
          updateCarDescription();
          if (typeof updateContent === 'function') {
            updateContent();
          }
          if (window.currentCarData) {
            populatePriceGuide(window.currentCarData);
          }
          if (window.priceCalculator && typeof window.priceCalculator.debouncedRecalculate === 'function') {
            window.priceCalculator.debouncedRecalculate();
          } else if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === 'function') {
            window.priceCalculator.recalculatePrice();
          }
        });
      }

      const getCarTypeTranslation = (carType) => {
        const translations = {
          'Sedan': i18next.t('cars.types.sedan', 'Sedan'),
          'SUV': i18next.t('cars.types.suv', 'SUV'),
          'Hatchback': i18next.t('cars.types.hatchback', 'Hatchback'),
          'Coupe': i18next.t('cars.types.coupe', 'Coupe'),
          'Wagon': i18next.t('cars.types.wagon', 'Wagon'),
          'Convertible': i18next.t('cars.types.convertible', 'Convertible'),
          'Van': i18next.t('cars.types.van', 'Van'),
          'Pickup': i18next.t('cars.types.pickup', 'Pickup'),
          'Crossover': i18next.t('cars.types.crossover', 'Crossover'),
          'Sports Car': i18next.t('cars.types.sports_car', 'Sports Car'),
          'Luxury': i18next.t('cars.types.luxury', 'Luxury'),
          'Electric': i18next.t('cars.types.electric', 'Electric'),
          'Hybrid': i18next.t('cars.types.hybrid', 'Hybrid')
        };
        return translations[carType] || carType || '-';
      };

      const getFuelTypeTranslation = (fuelType) => {
        const translations = {
          'Gasoline': i18next.t('cars.fuel.gasoline', 'Gasoline'),
          'Diesel': i18next.t('cars.fuel.diesel', 'Diesel'),
          'Electric': i18next.t('cars.fuel.electric', 'Electric'),
          'Hybrid': i18next.t('cars.fuel.hybrid', 'Hybrid'),
          'Plug-in Hybrid': i18next.t('cars.fuel.plugin_hybrid', 'Plug-in Hybrid'),
          'Hydrogen': i18next.t('cars.fuel.hydrogen', 'Hydrogen')
        };
        return translations[fuelType] || fuelType || '-';
      };

      const getTransmissionTranslation = (transmissionType) => {
        const translations = {
          'Manual': i18next.t('cars.transmission.manual', 'Manual'),
          'Automatic': i18next.t('cars.transmission.automatic', 'Automatic'),
          'CVT': i18next.t('cars.transmission.cvt', 'CVT'),
          'Semi-Automatic': i18next.t('cars.transmission.semi_automatic', 'Semi-Automatic')
        };
        return translations[transmissionType] || transmissionType || '-';
      };

      const compactSpecsHTML = `
        <div class="spec-card">
          <div>
            <svg fill="#7699a2" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240.235 240.235">
              <path d="M211.744,6.089C208.081,2.163,203.03,0,197.52,0h-15.143c-11.16,0-21.811,8.942-23.74,19.934l-0.955,5.436 c-0.96,5.47,0.332,10.651,3.639,14.589c3.307,3.938,8.186,6.106,13.74,6.106h19.561c2.714,0,5.339-0.542,7.778-1.504l-2.079,17.761 c-2.001-0.841-4.198-1.289-6.507-1.289h-22.318c-9.561,0-18.952,7.609-20.936,16.961l-19.732,93.027l-93.099-6.69 c-5.031-0.36-9.231,1.345-11.835,4.693c-2.439,3.136-3.152,7.343-2.009,11.847l10.824,42.618 c2.345,9.233,12.004,16.746,21.53,16.746h78.049h1.191h39.729c9.653,0,18.336-7.811,19.354-17.411l15.272-143.981 c0.087-0.823,0.097-1.634,0.069-2.437l5.227-44.648c0.738-1.923,1.207-3.967,1.354-6.087l0.346-4.97 C217.214,15.205,215.407,10.016,211.744,6.089z"></path>
            </svg>
          </div>
          <div>${car.num_passengers || '-'}</div>
        </div>
        <div class="spec-card">
          <div>
            <svg viewBox="0 0 24 24" height="18px" width="18px" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#5daada">
              <path d="M11 6H8C7.05719 6 6.58579 6 6.29289 6.29289C6 6.58579 6 7.05719 6 8C6 8.94281 6 9.41421 6.29289 9.70711C6.58579 10 7.05719 10 8 10H11C11.9428 10 12.4142 10 12.7071 9.70711C13 9.41421 13 8.94281 13 8C13 7.05719 13 6.58579 12.7071 6.29289C12.4142 6 11.9428 6 11 6Z" stroke="#465791" stroke-width="1.5"></path>
              <path d="M7 17H12" stroke="#465791" stroke-width="1.5" stroke-linecap="round"></path>
              <path d="M17 22H2" stroke="#465791" stroke-width="1.5" stroke-linecap="round"></path>
              <path d="M19.5 4L20.7331 4.98647C20.8709 5.09673 20.9398 5.15186 21.0025 5.20805C21.5937 5.73807 21.9508 6.48086 21.9953 7.27364C22 7.35769 22 7.44594 22 7.62244V18.5C22 19.3284 21.3284 20 20.5 20C19.6716 20 19 19.3284 19 18.5V18.4286C19 17.6396 18.3604 17 17.5714 17H16" stroke="#465791" stroke-width="1.5" stroke-linecap="round"></path>
              <path d="M22 8H20.5C19.6716 8 19 8.67157 19 9.5V11.9189C19 12.5645 19.4131 13.1377 20.0257 13.3419L22 14" stroke="#465791" stroke-width="1.5" stroke-linecap="round"></path>
              <path d="M16 22V15M3 22V18M3 14V8C3 5.17157 3 3.75736 3.87868 2.87868C4.75736 2 6.17157 2 9 2H10C12.8284 2 14.2426 2 15.1213 2.87868C16 3.75736 16 5.17157 16 8V11" stroke="#465791" stroke-width="1.5" stroke-linecap="round"></path>
            </svg>
          </div>
          <div>${getFuelTypeTranslation(car.fuel_type)}</div>
        </div>
        <div class="spec-card">
          <div>
            <svg viewBox="0 0 24 24" height="18px" width="18px" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 4C6 5.10457 5.10457 6 4 6C2.89543 6 2 5.10457 2 4C2 2.89543 2.89543 2 4 2C5.10457 2 6 2.89543 6 4Z" stroke="#1C274C" stroke-width="1.5"></path>
              <path d="M6 20C6 21.1046 5.10457 22 4 22C2.89543 22 2 21.1046 2 20C2 18.8954 2.89543 18 4 18C5.10457 18 6 18.8954 6 20Z" stroke="#1C274C" stroke-width="1.5"></path>
              <path d="M14 20C14 21.1046 13.1046 22 12 22C10.8954 22 10 21.1046 10 20C10 18.8954 10.8954 18 12 18C13.1046 18 14 18.8954 14 20Z" stroke="#1C274C" stroke-width="1.5"></path>
              <path d="M14 4C14 5.10457 13.1046 6 12 6C10.8954 6 10 5.10457 10 4C10 2.89543 10.8954 2 12 2C13.1046 2 14 2.89543 14 4Z" stroke="#1C274C" stroke-width="1.5"></path>
              <path d="M22 4C22 5.10457 21.1046 6 20 6C18.8954 6 18 5.10457 18 4C18 2.89543 18.8954 2 20 2C21.1046 2 22 2.89543 22 4Z" stroke="#1C274C" stroke-width="1.5"></path>
              <path opacity="0.5" d="M4.75 6C4.75 5.58579 4.41421 5.25 4 5.25C3.58579 5.25 3.25 5.58579 3.25 6H4.75ZM3.25 18C3.25 18.4142 3.58579 18.75 4 18.75C4.41421 18.75 4.75 18.4142 4.75 18H3.25ZM12.75 6C12.75 5.58579 12.4142 5.25 12 5.25C11.5858 5.25 11.25 5.58579 11.25 6H12.75ZM11.25 18C11.25 18.4142 11.5858 18.75 12 18.75C12.4142 18.75 12.75 18.4142 12.75 18H11.25ZM20.75 6C20.75 5.58579 20.4142 5.25 20 5.25C19.5858 5.25 19.25 5.58579 19.25 6H20.75ZM4 11.25C3.58579 11.25 3.25 11.5858 3.25 12C3.25 12.4142 3.58579 12.75 4 12.75V11.25ZM19.4142 11.4142L18.8839 10.8839L18.8839 10.8839L19.4142 11.4142ZM3.25 6V18H4.75V6H3.25ZM11.25 6V18H12.75V6H11.25ZM19.25 6V8H20.75V6H19.25ZM16 11.25H4V12.75H16V11.25ZM19.25 8C19.25 8.96401 19.2484 9.61157 19.1835 10.0946C19.1214 10.5561 19.0142 10.7536 18.8839 10.8839L19.9445 11.9445C20.4 11.4891 20.5857 10.9223 20.6701 10.2945C20.7516 9.68826 20.75 8.92161 20.75 8H19.25ZM16 12.75C16.9216 12.75 17.6883 12.7516 18.2945 12.6701C18.9223 12.5857 19.4891 12.4 19.9445 11.9445L18.8839 10.8839C18.7536 11.0142 18.5561 11.1214 18.0946 11.1835C17.6116 11.2484 16.964 11.25 16 11.25V12.75Z" fill="#1C274C"></path>
              <path d="M18 15V14.25C17.5858 14.25 17.25 14.5858 17.25 15H18ZM17.25 22C17.25 22.4142 17.5858 22.75 18 22.75C18.4142 22.75 18.75 22.4142 18.75 22H17.25ZM21.3604 22.3916C21.5766 22.7449 22.0384 22.8559 22.3916 22.6396C22.7449 22.4234 22.8559 21.9616 22.6396 21.6084L21.3604 22.3916ZM18 15.75H20.2857V14.25H18V15.75ZM18.75 18.5V15H17.25V18.5H18.75ZM21.25 16.75C21.25 17.3169 20.8038 17.75 20.2857 17.75V19.25C21.6612 19.25 22.75 18.1161 22.75 16.75H21.25ZM20.2857 15.75C20.8038 15.75 21.25 16.1831 21.25 16.75H22.75C22.75 15.3839 21.6612 14.25 20.2857 14.25V15.75ZM20.2857 17.75H19.8571V19.25H20.2857V17.75ZM19.8571 17.75H18V19.25H19.8571V17.75ZM19.2175 18.8916L21.3604 22.3916L22.6396 21.6084L20.4968 18.1084L19.2175 18.8916ZM17.25 18.5V22H18.75V18.5H17.25Z" fill="#1C274C"></path>
            </svg>
          </div>
          <div>${getTransmissionTranslation(car.gear_type)}</div>
        </div>
        <div class="spec-card">
          <div>
            <svg fill="#505b77" viewBox="0 -39.69 122.88 122.88" height="18px" width="18px" version="1.1" xmlns="http://www.w3.org/2000/svg">
              <path d="M103.94,23.97c5.39,0,9.76,4.37,9.76,9.76c0,5.39-4.37,9.76-9.76,9.76c-5.39,0-9.76-4.37-9.76-9.76 C94.18,28.34,98.55,23.97,103.94,23.97L103.94,23.97z M23,29.07v3.51h3.51C26.09,30.86,24.73,29.49,23,29.07L23,29.07z M26.52,34.87H23v3.51C24.73,37.97,26.09,36.6,26.52,34.87L26.52,34.87z M20.71,38.39v-3.51H17.2 C17.62,36.6,18.99,37.96,20.71,38.39L20.71,38.39z M17.2,32.59h3.51v-3.51C18.99,29.49,17.62,30.86,17.2,32.59L17.2,32.59z M105.09,29.07v3.51h3.51C108.18,30.86,106.82,29.49,105.09,29.07L105.09,29.07z M108.6,34.87h-3.51v3.51 C106.82,37.97,108.18,36.6,108.6,34.87L108.6,34.87z M102.8,38.39v-3.51h-3.51C99.71,36.6,101.07,37.96,102.8,38.39L102.8,38.39z M99.28,32.59h3.51v-3.51C101.07,29.49,99.71,30.86,99.28,32.59L99.28,32.59z M49.29,12.79c-1.54-0.35-3.07-0.35-4.61-0.28 C56.73,6.18,61.46,2.07,75.57,2.9l-1.94,12.87L50.4,16.65c0.21-0.61,0.33-0.94,0.37-1.55C50.88,13.36,50.86,13.15,49.29,12.79 L49.29,12.79z M79.12,3.13L76.6,15.6l24.13-0.98c2.48-0.1,2.91-1.19,1.41-3.28c-0.68-0.95-1.44-1.89-2.31-2.82 C93.59,1.86,87.38,3.24,79.12,3.13L79.12,3.13z M0.46,27.28H1.2c0.46-2.04,1.37-3.88,2.71-5.53c2.94-3.66,4.28-3.2,8.65-3.99 l24.46-4.61c5.43-3.86,11.98-7.3,19.97-10.2C64.4,0.25,69.63-0.01,77.56,0c4.54,0.01,9.14,0.28,13.81,0.84 c2.37,0.15,4.69,0.47,6.97,0.93c2.73,0.55,5.41,1.31,8.04,2.21l9.8,5.66c2.89,1.67,3.51,3.62,3.88,6.81l1.38,11.78h1.43v6.51 c-0.2,2.19-1.06,2.52-2.88,2.52h-2.37c0.92-20.59-28.05-24.11-27.42,1.63H34.76c3.73-17.75-14.17-23.91-22.96-13.76 c-2.67,3.09-3.6,7.31-3.36,12.3H2.03c-0.51-0.24-0.91-0.57-1.21-0.98c-1.05-1.43-0.82-5.74-0.74-8.23 C0.09,27.55-0.12,27.28,0.46,27.28L0.46,27.28z M21.86,23.97c5.39,0,9.76,4.37,9.76,9.76c0,5.39-4.37,9.76-9.76,9.76 c-5.39,0-9.76-4.37-9.76-9.76C12.1,28.34,16.47,23.97,21.86,23.97L21.86,23.97z"></path>
            </svg>
          </div>
          <div>${getCarTypeTranslation(car.car_type)}</div>
        </div>
        <div class="spec-card">
          <div>
            <svg fill="#5a7990" height="18px" width="18px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 491.52 491.52">
              <path d="M471.04,163.84h-32.768c-8.192,0-16.384,6.144-20.48,14.336l-18.432,81.92l-14.336-40.96 c0-8.192-8.192-14.336-16.384-14.336h-40.96v-20.48c0-12.288-8.192-20.48-20.48-20.48H81.92c-10.24,0-20.48,8.192-20.48,20.48 v163.84c0,2.048,0,6.144,2.048,8.192l28.672,61.44c4.096,8.192,10.24,12.288,18.432,12.288H358.4 c8.192,0,14.336-4.096,18.432-10.24l18.432-30.72h6.144l18.432,49.152c4.096,8.192,10.24,12.288,18.432,12.288h32.768 c12.288,0,20.48-8.192,20.48-20.48V184.32C491.52,172.032,483.328,163.84,471.04,163.84z M458.752,421.888l-24.576-61.44 c-4.096-6.144-10.24-12.288-20.48-12.288h-32.768c-8.192,0-14.336,4.096-18.432,10.24l-16.384,30.72H124.928L102.4,344.064V204.8 h184.32v20.48c0,12.288,8.192,20.48,20.48,20.48h47.104l8.192,26.624c2.048,8.192,10.24,14.336,18.432,14.336h32.768 c8.192,0,16.384-6.144,20.48-14.336l24.576-81.92V421.888z"></path>
              <path d="M81.92,266.24H20.48C8.192,266.24,0,274.432,0,286.72c0,12.288,10.24,20.48,20.48,20.48h61.44 c12.288,0,20.48-8.192,20.48-20.48C102.4,274.432,94.208,266.24,81.92,266.24z"></path>
              <path d="M20.48,225.28C8.192,225.28,0,233.472,0,245.76v81.92c0,12.288,8.192,20.48,20.48,20.48c12.288,0,20.48-8.192,20.48-20.48 v-81.92C40.96,233.472,32.768,225.28,20.48,225.28z"></path>
              <path d="M245.76,102.4h-81.92c-10.24,0-20.48,8.192-20.48,20.48v61.44c0,12.288,10.24,20.48,20.48,20.48h81.92 c12.288,0,20.48-8.192,20.48-20.48v-61.44C266.24,110.592,258.048,102.4,245.76,102.4z M225.28,163.84h-40.96v-20.48h40.96V163.84 z"></path>
              <path d="M286.72,40.96H122.88c-10.24,0-20.48,8.192-20.48,20.48v61.44c0,12.288,10.24,20.48,20.48,20.48h163.84 c12.288,0,20.48-8.192,20.48-20.48V61.44C307.2,49.152,299.008,40.96,286.72,40.96z M266.24,102.4H143.36V81.92h122.88V102.4z"></path>
            </svg>
          </div>
          <div>${car.engine_capacity ? car.engine_capacity + 'L' : '-'}</div>
        </div>
        <div class="spec-card">
          <div>
            <svg viewBox="0 0 24 24" height="18px" width="18px" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="#485284" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </div>
          <div>${car.production_year || '-'}</div>
        </div>
      `;

      document.getElementById('car-specs-compact').innerHTML = compactSpecsHTML;

      i18next.on('languageChanged', () => {
        if (window.currentCarData) {
          populatePriceGuide(window.currentCarData);
        }
      });

      window.updateFeeDisplays = async function () {
        try {
          const response = await fetch(`${window.API_BASE_URL}/api/fee-settings/public`);
          if (response.ok) {
            const fees = await response.json();
            const outsideHoursFeeElement = document.getElementById('outside-hours-fee');
            if (outsideHoursFeeElement && fees.outside_hours_fee !== undefined) {
              outsideHoursFeeElement.textContent = `€${fees.outside_hours_fee}`;
            }
          }
        } catch (error) {
          // Error handling
        }
      };

      if (window.priceCalculator) {
        window.priceCalculator.updateCarData(car);
        updateFeeDisplays();
      } else {
        setTimeout(async () => {
          if (window.priceCalculator) {
            window.priceCalculator.updateCarData(car);
            updateFeeDisplays();
          }
        }, 100);
      }

      if (window.priceCalculator) {
        const discountInput = document.querySelector('input[name="discount_code"]');
        if (discountInput && discountInput.value.trim().length >= 3) {
          setTimeout(() => {
            discountInput.dispatchEvent(new Event('blur'));
          }, 500);
        }
      }

      function initializeAccordion() {
        const bookingSections = document.querySelectorAll('.booking-section');

        function isMobile() {
          return window.innerWidth <= 767;
        }

        bookingSections.forEach((section) => {
          const title = section.querySelector('h5');

          if (title) {
            title.addEventListener('click', function (e) {
              if (isMobile()) {
                const isCollapsed = section.classList.contains('collapsed');

                if (isCollapsed) {
                  section.classList.remove('collapsed');
                } else {
                  section.classList.add('collapsed');
                }
              }
            });
          }
        });
      }

      const discountInput = document.querySelector('input[name="discount_code"]');

      if (discountInput) {
        let validationTimeout;

        discountInput.addEventListener('input', function () {
          if (window.cachedCouponData) {
            window.cachedCouponData = null;
            window.lastValidatedCouponCode = null;
          }

          if (validationTimeout) {
            clearTimeout(validationTimeout);
          }
          
          if (window.priceCalculator && typeof window.priceCalculator.hideFloatingFreeDaysNotification === 'function') {
            window.priceCalculator.hideFloatingFreeDaysNotification();
          }
          
          if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === 'function') {
            window.priceCalculator.recalculatePrice();
          }
        });

        discountInput.addEventListener('blur', async function () {
          const code = this.value.trim();

          if (code && code.length >= 3) {
            try {
              const phoneInput = document.querySelector('input[name="customer_phone"]');
              const phoneNumber = phoneInput ? phoneInput.value.trim() : '';
              const phoneParam = phoneNumber ? `?phone=${encodeURIComponent(phoneNumber)}` : '';

              let response = await fetch(`${window.API_BASE_URL}/api/coupons/lookup/${code}${phoneParam}`);
              let result = await response.json();

              if (!result.valid) {
                response = await fetch(`${window.API_BASE_URL}/api/coupons/validate/${code}`);
                result = await response.json();
              }

              if (result.valid) {
                this.classList.remove("is-invalid");
                this.classList.add("is-valid");
                window.cachedCouponData = result;
                window.lastValidatedCouponCode = code;

                const existingMessage = document.querySelector(".coupon-message");
                if (existingMessage) {
                  existingMessage.remove();
                }

                if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === 'function') {
                  window.priceCalculator.recalculatePrice();
                }
              } else {
                this.classList.remove("is-valid");
                this.classList.add("is-invalid");
                if (window.priceCalculator && typeof window.priceCalculator.hideFloatingFreeDaysNotification === 'function') {
                  window.priceCalculator.hideFloatingFreeDaysNotification();
                }
                window.cachedCouponData = null;
                window.lastValidatedCouponCode = null;
              }
            } catch (error) {
              this.classList.remove("is-valid");
              this.classList.add("is-invalid");
            }
          } else if (code.length === 0) {
            if (window.priceCalculator && typeof window.priceCalculator.hideFloatingFreeDaysNotification === 'function') {
              window.priceCalculator.hideFloatingFreeDaysNotification();
            }
            this.classList.remove("is-valid", "is-invalid");
            window.cachedCouponData = null;
            window.lastValidatedCouponCode = null;
          }
        });

        discountInput.addEventListener('focus', function () {
          const code = this.value.trim();

          if (code && code.length >= 3 &&
            (!window.cachedCouponData || window.lastValidatedCouponCode !== code)) {
            setTimeout(() => {
              this.dispatchEvent(new Event('blur'));
            }, 100);
          }
        });
      }
    });

    function showImmediatePriceInfo(car, lowestPrice) {
      const priceContent = document.getElementById('price-content');
      const priceLoading = document.getElementById('price-loading');

      if (priceContent && priceLoading) {
        priceLoading.style.display = 'none';
        priceContent.style.display = 'block';

        priceContent.innerHTML = `
          <div style="text-align: center; color: #333;">
            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px; color: #007bff;">
              €${lowestPrice}/day
            </div>
            <div style="font-size: 12px; color: #666;">
              <span data-i18n="cars.daily_rate"></span>
            </div>
            <div style="font-size: 11px; color: #999; margin-top: 6px;">
              <i class="fa fa-info-circle"></i> 
              <span data-i18n="cars.loading_breakdown">Loading detailed breakdown...</span>
            </div>
          </div>
        `;

        if (typeof updateContent === 'function') {
          updateContent();
        }
      }
    }

    function populatePriceGuide(car) {
      const priceTiersMainDiv = document.getElementById('price-tiers-main');
      if (priceTiersMainDiv && car.price_policy) {
        const pricePolicy = typeof car.price_policy === 'string' ? JSON.parse(car.price_policy) : car.price_policy;

        const mainTiersHTML = Object.entries(pricePolicy).map(([period, price]) => {
          let periodText;
          let perDayText = i18next.t('cars.price_tiers.per_day', '/day');

          switch (period) {
            case '1-2':
              periodText = i18next.t('cars.price_tiers.1_2_days', '1-2 days');
              break;
            case '3-7':
              periodText = i18next.t('cars.price_tiers.3_7_days', '3-7 days');
              break;
            case '8-20':
              periodText = i18next.t('cars.price_tiers.8_20_days', '8-20 days');
              break;
            case '21-45':
              periodText = i18next.t('cars.price_tiers.21_45_days', '21-45 days');
              break;
            case '46+':
              periodText = i18next.t('cars.price_tiers.46_plus_days', '46+ days');
              break;
            default:
              periodText = period;
          }

          return `
            <div style="background: #f8f9fa; padding: 8px 12px; border-radius: 6px; border-left: 3px solid #007bff; text-align: center; min-width: 80px; flex: 1;">
              <div style="font-size: 11px; color: #666; margin-bottom: 3px; line-height: 1.2;">${periodText}</div>
              <div style="font-size: 14px; font-weight: 700; color: #007bff; line-height: 1.2;">€${price}${perDayText}</div>
            </div>
          `;
        }).join('');

        priceTiersMainDiv.innerHTML = mainTiersHTML;

        if (typeof updateContent === 'function') {
          updateContent();
        }
      }
    }
  </script>

  <script>
    const pickupLocationInputs = document.querySelectorAll('input[name="pickup_location"]');
    const dropoffLocationInputs = document.querySelectorAll('input[name="dropoff_location"]');
    
    pickupLocationInputs.forEach(input => {
      input.addEventListener('change', function () {
        if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === 'function') {
          window.priceCalculator.recalculatePrice();
        }
      });
    });

    dropoffLocationInputs.forEach(input => {
      input.addEventListener('change', function () {
        if (window.priceCalculator && typeof window.priceCalculator.recalculatePrice === 'function') {
          window.priceCalculator.recalculatePrice();
        }
      });
    });
  </script>

</body>
</html>
